<!DOCTYPE html>
<html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
  <meta content="en-us" http-equiv="content-language"/>
  <link href="https://www.duffysmvp.com" hreflang="en-us" rel="alternate"/>
  <meta charset="utf-8"/>
  <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
  <meta content="width=device-width, maximum-scale=1, initial-scale=1" name="viewport"/>
  <meta content="https://www.duffysmvp.com/images/duffys_mvp.png" property="og:image"/>
  <meta content="https://www.duffysmvp.com/images/duffys_mvp.png" property="og:image:secure_url"/>
  <meta content="291" property="og:image:height"/>
  <meta content="437" property="og:image:width"/>
  <meta content="Duffy’s Sports Grill" property="og:image:alt"/>
  <meta content="image/png" property="og:image:type"/>
  <meta content="burgers, wings, south florida, best, sports, grill, sports bar, happy hour, family restaurant, 2x1" name="keywords"/>
  <title>
   Duffy’s Sports Grill
                 | Menu | Steaks, Chops, Seafood &amp; Pasta
  </title>
  <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon"/>
  <link href="/favicon.ico" rel="icon" type="image/x-icon"/>
  <meta content="#005e23" name="theme-color"/>
  <script src="/js/modernizr-custom.js">
  </script>
  <link href="/css/bootstrap.css" rel="stylesheet"/>
  <link href="/css/animate.css" rel="stylesheet"/>
  <link href="/css/icons_v3.css" rel="stylesheet"/>
  <link href="/css/owl.carousel.css" rel="stylesheet"/>
  <link href="/css/owl.theme.default.css" rel="stylesheet"/>
  <!-- <link href="/css/font-awesome.css" rel="stylesheet" /> -->
  <link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:100,300,300i,400,400i,700|Ubuntu+Condensed|Ubuntu:400,700" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css?family=Raleway:700,900" rel="stylesheet"/>
  <link href="/css/style.css" rel="stylesheet"/>
  <link href="/css/mvp-style.css" rel="stylesheet"/>
  <link href="/css/menu-style.css" rel="stylesheet"/>
  <link href="/css/cart-style.css" rel="stylesheet"/>
  <link href="/css/about-style.css" rel="stylesheet"/>
  <link href="/css/press-style.css" rel="stylesheet"/>
  <link href="/css/careers-style.css" rel="stylesheet"/>
  <link href="/css/gift-cards.css" rel="stylesheet"/>
  <link href="/css/about-detail-style.css" rel="stylesheet"/>
  <link href="/css/contact-style.css" rel="stylesheet"/>
  <link href="/css/location-style.css" rel="stylesheet"/>
  <link href="/css/modifiers.css" rel="stylesheet"/>
  <link href="/css/editor.css" rel="stylesheet"/>
  <link href="/css/memorial.css" rel="stylesheet"/>
  <link href="/css/bracket.css" rel="stylesheet"/>
  <link href="/css/polyfill.object-fit.css" rel="stylesheet"/>
  <link href="/css/aos.css" rel="stylesheet"/>
  <link href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" rel="stylesheet"/>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js">
  </script>
  <script src="https://code.jquery.com/ui/1.11.2/jquery-ui.js">
  </script>
  <script async="" defer"="" src="https://www.google.com/recaptcha/api.js?onload=onloadCallback&amp;render=explicit">
  </script>
  <script src="/js/repeat.js">
  </script>
  <script src="/js/libs/jquery.validate.min.js">
  </script>
  <script src="/js/libs/js.cookie.js">
  </script>
  <script src="/js/libs/js.storage.min.js">
  </script>
  <script src="/js/libs/twitterFetcher_min.js">
  </script>
  <script src="/js/libs/jquery-dateFormat.min.js">
  </script>
  <script src="/js/libs/jquery.inputmask.bundle.min.js">
  </script>
  <script src="/js/libs/jquery.waypoints.min.js">
  </script>
  <script src="/js/main.js?v=v1">
  </script>
  <!-- Include all compiled plugins (below), or include individual files as needed -->
  <script src="/js/bootstrap.min.js">
  </script>
  <script src="/js/owl.carousel.js">
  </script>
  <!-- <script src="/js/prefixfree.min.js"></script> -->
  <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
            <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
  <!-- Google Tag Manager -->
  <script>
   (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-TDSFSTP');
  </script>
  <!-- End Google Tag Manager -->
  <script>
   // This example requires the Places library. Include the libraries=places
        // parameter when you first load the API. For example:
        // <script src="https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY&libraries=places">


        var stateBounds = {
            fl: ['25.761681', '-80.191788']
            // lat/long boundaries list for states/provinces.
        };
        function getStateBounds(state) {
            return new google.maps.LatLngBounds(new google.maps.LatLng(stateBounds[state][0], stateBounds[state][1]));
        }

        function initMap() {


            var input = document.getElementById('search_location');

            var options = {
                types: ['address'],
                componentRestrictions: { country: 'us' },
                bounds: getStateBounds('fl')
            };

            var autocomplete = new google.maps.places.Autocomplete(input, options);

            // Bind the map's bounds (viewport) property to the autocomplete object,
            // so that the autocomplete requests use the current map bounds for the
            // bounds option in the request.




            autocomplete.addListener('place_changed', function () {

                var place = autocomplete.getPlace();
                if (!place.geometry) {
                    // User entered the name of a Place that was not suggested and
                    // pressed the Enter key, or the Place Details request failed.
                    // window.alert("No details available for input: '" + place.name + "'");
                    return;
                }

                // If the place has a geometry, then present it on a map.
                if (place.geometry.viewport) {
                    // alert(place.geometry.location);
                    //map.fitBounds(place.geometry.viewport);
                } else {
                    // alert(place.geometry.location);
                    // map.setCenter(place.geometry.location);
                    // map.setZoom(17);  // Why 17? Because it looks good.
                }
                console.log("My address;" + place.formatted_address);


                var address = '';
                if (place.address_components) {

                    address = [
                        (place.address_components[0] && place.address_components[0].short_name || ''),
                        (place.address_components[1] && place.address_components[1].short_name || ''),
                        (place.address_components[2] && place.address_components[2].short_name || '')
                    ].join(' ');



                }
                var address1 = place.address_components;
                var zipcode = '';


                for (var i = 0; i < address1.length; i++) {
                    if (address1[i].types.includes("postal_code")) { zipcode = address1[i].short_name; }

                }

                app.ajax.storeDelivery(place.geometry.location.lat(), place.geometry.location.lng(), zipcode, function (data) {
                    $('#modalAddress .store-delivery-container').html('');
                    if (data.length <= 0 || data.code == null) {
                        $('#idSearchMessage').html('').append('<p>Delivery is unavailable in your area at this time.</p>');
                    } else {
                        $('#idSearchMessage').html('');
                        // app.globals.menuCart.SearchAddress = $('#search_location').val();
                        app.globals.menuCart.SearchAddress = place.formatted_address;
                        printStoreDelivery(data);

                    }
                });


            });

            // Sets a listener on a radio button to change the filter type on Places
            // Autocomplete.





        }
  </script>
  <meta content="The Food You Love featuring Award-Winning Burgers, Wings, and more. Just a click away." name="description"/>
 </head>
 <body id="mainBody">
  <!-- Google Tag Manager (noscript) -->
  <noscript>
   <iframe height="0" src="https://www.googletagmanager.com/ns.html?id=GTM-TDSFSTP" style="display:none;visibility:hidden" width="0">
   </iframe>
  </noscript>
  <!-- End Google Tag Manager (noscript) -->
  <!-- MODAL DELIVERY SEARCH LOCATION -->
  <div aria-labelledby="myModalLabelAddress" class="modal fade" id="modalAddress" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" onclick="app.menuCart.clean();" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <h4 class="modal-title" id="myModalLabelAddress">
       Enter Your Delivery Address
      </h4>
     </div>
     <div class="modal-body">
      <div class="row">
       <div class="address-search-container">
        <div class="form-group col-xs-12 col-sm-9 col-md-9 col-lg-9">
         <label for="search_location">
          Enter Your Address
         </label>
         <input class="form-control" id="search_location" placeholder="Enter Your Address" type="text"/>
        </div>
        <div class="form-group col-xs-12 col-sm-3 col-md-3 col-lg-3">
         <label for="search-apt-number">
          Suite/Apt
         </label>
         <input class="form-control" id="search-apt-number" placeholder="Suite/Apt" type="text"/>
        </div>
       </div>
      </div>
      <div class="row">
       <div class="col-xs-12 col-sm-12" id="idSearchMessage">
       </div>
      </div>
      <div class="store-delivery-container">
      </div>
      <div class="row text-center">
       <button class="button button-small button-yellow" onclick="app.utils.changeToTakeOut()">
        <span>
         Change to Takeout
        </span>
       </button>
      </div>
     </div>
     <div class="modal-footer">
      <button class="btn btn-primary hidden" data-dismiss="modal" type="button">
       Accept Location
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL SELECT OLO TYPE -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalOloType" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <!-- <h4 class="modal-title text-center" id="myModalLabel">Welcome to Duffy's Online Ordering</h4> -->
     </div>
     <div class="modal-body text-center">
      <img alt="Duffy’s Sports Grill" class="olo-logo" src="/images/duffys-logo-transparent.png"/>
      <div class="subcategory-container">
       <button class="subcategory-item" id="btPayStore" onclick="app.utils.sendAnalytics('OO','Delivery','click-modal');selectOLOTypeMethod('delivery')">
        <div class="text">
         <h1>
          Delivery
         </h1>
        </div>
       </button>
       <button class="subcategory-item" id="btPayStore" onclick="selectOLOTypeMethod('pickUp')">
        <div class="text">
         <h1>
          Curbside Pick Up
         </h1>
        </div>
       </button>
      </div>
      <h3 class="small">
       MVP points are not issued, and MVP rewards are not a valid form of payment, in any transaction involving a third party ordering or delivery service.
      </h3>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL SELECT PAYMENT TYPE -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalPaymentType" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <!-- <h4 class="modal-title text-center" id="myModalLabel">Welcome to Duffy's Online Ordering</h4> -->
     </div>
     <div class="modal-body text-center">
      <!-- <img class="olo-logo" src="images/duffys-logo-transparent.png" alt=""> -->
      <h2 class="text-center">
       Please select your payment method.
      </h2>
      <div class="subcategory-container">
       <button class="subcategory-item col-xs-12 col-md-6" id="btPayStore" onclick="selectPayMethod('pickUp')">
        <div class="text">
         <h1>
          Pay Online
         </h1>
        </div>
       </button>
       <button class="subcategory-item col-xs-12 col-md-6" id="btPayStore" onclick="selectPayMethod('pickUp')">
        <div class="text">
         <h1>
          Pay at the store
         </h1>
        </div>
       </button>
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- MEMORIAL MODAL -->
  <!-- <div id="modalMemorial" class="modal fake-modal-show">
            <div class="container-fluid home-section memorial-home">
                <div class="container home-container">
                    <div class="row home-claim">
                        <img src="images/duffys-logo-white.png" class="memorial-logo animated fadeIn" alt="Duffy's Logo">
                        <p class="animated fadeIn">Today we remember</p>
                        <h1 class="animated fadeIn">
                                Paul Emmett<hr /><span>1952-2015</span>
                            </h1>
        
                        <div class="modal-memorial-claim-buttons">
    
                            <a href="https://www.duffysmvp.com/paulemmett/" class="button transition animated fadeInLeft">View the Memorial Video</a>
    
                            <a href="https://www.duffysmvp.com/paularticle/" class="button transition animated fadeInLeft">Remembering Paul Article</a>
    
                            <a href="https://www.duffysmvp.com/espntribute/" class="button transition animated fadeInLeft">Listen to the ESPN Tribute</a>
        
                            <p onclick="hideFakeModal()" data-dismiss="modal" class="button transition animated fadeInLeft">Continue to Website</p>
    
                        </div>
                    </div>
        
                </div>
                <div class="home-bottom-gradient"></div>
            </div>
        </div> -->
  <!-- GENERIC MODAL-->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalGeneric" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <h4 class="modal-title" id="myModalLabel">
       Modal title
      </h4>
     </div>
     <div class="modal-body">
      <p>
       Sorry, there’s been a connection error, please try again and let us know if the problem persists
      </p>
     </div>
     <div class="modal-footer">
      <button class="btn btn-default" data-dismiss="modal" id="cancelButton" type="button">
       Cancel
      </button>
      <button class="btn btn-primary" data-dismiss="modal" id="okButton" type="button">
       Ok
      </button>
     </div>
    </div>
   </div>
  </div>
  <div aria-labelledby="myModalLabelKO" class="modal fade" id="modalGenericOLOKO" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <h4 class="modal-title" id="myModalLabelKO">
       Modal title
      </h4>
     </div>
     <div class="modal-body">
      <p>
       Sorry, there’s been a connection error, please try again and let us know if the problem persists
      </p>
     </div>
     <div class="modal-footer">
      <button class="btn btn-default" data-dismiss="modal" id="cancelButtonKO" type="button">
       Cancel
      </button>
      <button class="btn btn-primary" id="okButtonKO" type="button">
       Ok
      </button>
     </div>
    </div>
   </div>
  </div>
  <div aria-labelledby="myModalLabelStore" class="modal fade" id="modalGenericStoreChnage" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <h4 class="modal-title" id="myModalLabelStore">
       Modal title
      </h4>
     </div>
     <div class="modal-body">
      <p>
       Sorry, there’s been a connection error, please try again and let us know if the problem persists
      </p>
     </div>
     <div class="modal-footer">
      <button class="btn btn-default" data-dismiss="modal" id="cancelButtonStore" type="button">
       Cancel
      </button>
      <button class="btn btn-primary" id="okButtonStore" type="button">
       Ok
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL BRACKET -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalBracket" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <h4 class="modal-title">
       Create Screen Name
      </h4>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <div class="modal-body" id="registerFormContainer">
      <!-- <h1>Restore password</h1> -->
      <div class="form-group" id="divNewUsername">
       <label for="bracketUsername">
        Screen Name*
       </label>
       <input class="form-control" id="newScreenNameBracket" maxlength="25" placeholder="Insert Screen Name" type="text" value="">
        <label for="bracketNote">
         * Please note, screen names will be shown on the public leader board.
        </label>
       </input>
      </div>
      <div class="form-group hidden" id="divFavoriteStore">
       <label for="favoriteStore">
        Favorite Store*
       </label>
       <select class="form-control" id="locationFavorite" name="locationFavorite">
        <option disabled="" selected="" value="null">
         Please, choose one.
        </option>
       </select>
      </div>
      <div class="modal-body" id="error-bracket" style="display: none;">
       <div class="error-message" style="display: block;">
        <i aria-hidden="true" class="fa fa-exclamation-circle">
        </i>
        <span id="errorText">
        </span>
       </div>
      </div>
     </div>
     <div class="modal-footer">
      <button class="button button-green transition btn-small" id="btnCreateNewScreenNameBracket" value="Create Screen Name">
       Create Screen Name
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- COOKIES MODAL-->
  <!-- MODAL LOADING-->
  <div aria-labelledby="modalLoadingLabel" class="modal fade modal-loading" id="modalLoading" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-body">
      <img alt="loading icon" class="loading-img flip-horizontal-bottom" src="/images/loading.png"/>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL PROCESING ORDER -->
  <div aria-labelledby="modalLoadingLabel" class="modal fade modal-processing" id="modalLoadingSaveOLO" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-body">
      <img alt="Processing animation" class="loading-img" src="/images/processing-order.svg"/>
      <h3>
       Processing order...
      </h3>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL REWARD CARD-->
  <div aria-labelledby="myModalLabel" class="modal fade modal-reward modal-reward-cards" id="reward-dollar-modal" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <h4 class="modal-title" id="myModalLabel">
       Use your Reward Dollars
      </h4>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <!-- CARD VIEW -->
     <div class="modal-body" id="divCheckCardNum">
      <h2>
       Please enter the 16 digit account number  on the back of your card.
      </h2>
      <div class="discount-card-container">
       <div class="card">
        <div class="card-front card-side">
         <!-- CHANGE IMG BETWEEN PARTNER PLUS & GIFT CARD -->
         <img alt="Duffy’s Partner plus card" id="imgCardType" src="/images/cards/partner-plus-card.png"/>
         <!-- <img src="images/cards/giftcard.png" alt=""> -->
        </div>
        <div class="card-back card-side">
         <div class="card-content">
          <img alt="Duffy’s Sports Grill" src="/images/duffys-logo-full-grey.png"/>
          <div class="row card-inputs">
           <input class="card-number" id="inputNumCardDiscount" placeholder="Card number" type="text">
            <input class="reg-code" id="inputNumCardDiscountRegCode" placeholder="Reg code" type="text"/>
           </input>
          </div>
         </div>
         <div class="black-wand">
         </div>
        </div>
       </div>
      </div>
     </div>
     <!-- RANGE VIEW -->
     <div class="modal-body" id="divSelectRange">
      <!-- HEADER FOR REWARDS DOLLARS -->
      <div class="mvp-user-info points-info" id="divRangeRewardDollar">
       <div class="img-user-container header">
        <img alt="" src=""/>
       </div>
       <div class="mvp-user-info-data">
        <h2 id="fullName">
         Username Surname
        </h2>
        <div class="mvp-balanceResumen">
         <span>
          $
          <b id="userMoney">
          </b>
          <small>
           REWARD DOLLARS
          </small>
         </span>
         <span>
          <b id="userPoints">
          </b>
          <small>
           POINTS
          </small>
         </span>
        </div>
       </div>
      </div>
      <!-- HEADER FOR PARTNER & GIFT CARDS -->
      <div class="mvp-user-info card-info" id="divRangePartnerPlus">
       <div class="card-img header">
        <!-- CHANGE IMG BETWEEN PARTNER PLUS & GIFT CARD -->
        <img alt="Duffy’s Card" src="/images/cards/partner-plus-card.png"/>
        <!-- <img src="images/cards/giftcard.png" alt=""> -->
       </div>
       <div class="mvp-user-info-data">
        <h2>
         Type of Card
        </h2>
        <div class="mvp-balanceResumen">
         <p>
          Number: 6000521010002001
         </p>
         <span>
          $
          <b>
           XX
          </b>
          <small>
           Remaining
          </small>
         </span>
        </div>
       </div>
      </div>
      <div class="range-content">
       <h3>
        How much do you want to spend?
       </h3>
       <div class="modal-reward-form">
        <input name="numberInput" type="number"/>
        <span>
         / $xx
        </span>
       </div>
       <button class="button button-green button-small" onclick="applyTotalRange();">
        Total
       </button>
       <button class="button button-green button-small" id="btApply" onclick="applyDiscountReward()" type="button">
        Apply
       </button>
      </div>
     </div>
     <div class="googleRecaptcha">
      <div class="g-recaptcha" id="checkBalanceOLORecaptcha">
      </div>
     </div>
     <div class="modal-body" id="Error-Reward-dollar-modal" style="display: none;">
      <div class="error-message" style="display: block;">
       <i aria-hidden="true" class="fa fa-exclamation-circle">
       </i>
       <span>
       </span>
      </div>
     </div>
     <!-- MODAL FOOTER -->
     <div class="modal-footer">
      <button class="button button-light button-white" data-dismiss="modal" id="btCancel" type="button">
       Cancel
      </button>
      <button class="button button-light button-white" id="btCheckCard" onclick="checkPartnerPlusCardDiscount()" type="button">
       Check Card
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL ITEM REWARDS -->
  <div aria-labelledby="modalRewards" class="modal fade" id="rewards-modal" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <h4 class="modal-title">
       Your Rewards
      </h4>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <div class="modal-body">
      <div class="rewards-buttons-container">
       <div class="reward-button">
        <div class="reward-image">
         <img alt="Rewards" src="/images/rewardDollars.png"/>
        </div>
        <div class="reward-button-text rewards-apply">
         <h3>
          Free reward item
         </h3>
         <p>
          Available for
          <b>
           Reward item name
          </b>
          <i>
           -$9.99
          </i>
         </p>
         <button class="button button-light button-small button-white">
          Apply
         </button>
        </div>
        <div class="reward-button-text rewards-edit hidden">
         <h3>
          Reward item name
         </h3>
         <p>
          -9.99 Applied
         </p>
         <button class="button button-light button-small button-white">
          Remove
         </button>
        </div>
       </div>
      </div>
     </div>
     <div class="modal-footer">
      <button class="btn btn-default" data-dismiss="modal" type="button">
       Cancel
      </button>
      <button class="btn btn-primary hidden" type="button">
       Apply / Edit
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL RESTORE PASSWORD  -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalRestorePassword" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content custom-modal">
     <div class="modal-header">
      <h4 class="modal-title">
       Restore password
      </h4>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <div class="mvp-login-form modal-body" id="registerFormContainer">
      <!-- <h1>Restore password</h1> -->
      <p>
       You can reset your password through
       <span class="important" color="danger">
        ONE
       </span>
       of the following methods
      </p>
      <form id="restorePasswordForm">
       <div class="form-separator">
        <h4>
         <b>
          Method 1:
         </b>
        </h4>
        <span>
         Using your username
        </span>
       </div>
       <div class="form-group small">
        <input class="form-control" id="username" name="username" placeholder="Username" type="text"/>
       </div>
       <div class="form-separator">
        <h4>
         <b>
          Method 2:
         </b>
        </h4>
        <span>
         Using your email
        </span>
       </div>
       <div class="form-group small">
        <input class="form-control" id="email" name="email" placeholder="Email" type="text"/>
       </div>
       <div class="form-separator">
        <h4>
         <b>
          Method 3:
         </b>
        </h4>
        <span>
         Using your MVP Card number
        </span>
       </div>
       <div class="form-group small">
        <input class="form-control" id="card" name="card" placeholder="MVP card number" type="text"/>
       </div>
       <div class="error-message">
        <i aria-hidden="true" class="fas fa-exclamation-circle">
        </i>
        <span>
         Sorry, there’s been a connection error, please try again and let us know if the problem persists
        </span>
       </div>
       <div class="alert alert-success" id="update-success" role="alert">
       </div>
       <div class="row">
        <div class="col-md-12">
         <button class="button button-green transition bt-full" id="restorePasswordButton" type="submit">
          <img alt="loading icon" class="loading-ico animated rotateIn" src="/images/loading.svg"/>
          <span>
           Reset password
          </span>
         </button>
        </div>
       </div>
      </form>
     </div>
     <div class="modal-footer">
      <div class="text-left">
       <p>
        <b class="green-text">
         Atention!
        </b>
       </p>
       <p>
        Submit only one request. It may take some time to receive our password reset email.
       </p>
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL REGISTER -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalRegister" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content custom-modal">
     <div class="modal-header">
      <h4 class="modal-title">
       Join Our MVP Program
      </h4>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <div class="mvp-login-form modal-body" id="registerFormContainer">
      <img alt="MVP Card" src="/images/newcard.png"/>
      <form id="registerForm">
       <div class="form-group small hidden">
        <input class="form-control" id="numberCard" placeholder="Card number" type="text"/>
        <small>
         Enter your card number, do not include any spaces.
        </small>
       </div>
       <div class="form-group small hidden">
        <input class="form-control" id="registrationCode" name="registrationCode" placeholder="Registration code" type="text"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="firstName" name="firstName" placeholder="First name" type="text"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="lastName" name="lastName" placeholder="Last name" type="text"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="mobilePhone" name="mobilePhone" placeholder="Mobile phone" type="text"/>
       </div>
       <div class="form-group small">
        <input autocomplete="off" class="form-control" data-toggle="datepickerBirthday" id="birthday" name="birthday" placeholder="Birthday (mm/dd/yyyy)"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="emailRegister" name="emailRegister" placeholder="Email address" type="text"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="repeatEmailRegister" name="repeatEmailRegister" placeholder="Verify email address" type="text"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="user" name="user" placeholder="Username" type="text"/>
       </div>
       <div class="form-group small">
        <select class="form-control" id="location" name="location">
         <option value="">
          Choose a store
         </option>
        </select>
       </div>
       <div class="form-group small">
        <input class="form-control" id="pass" name="pass" placeholder="Password" type="password"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="repeatPass" name="repeatPass" placeholder="Repeat password" type="password"/>
       </div>
       <div class="form-group small">
        <input class="form-control" id="promo" name="promo" placeholder="Promo code (optional)" type="text"/>
       </div>
       <hr/>
       <div class="checkbox">
       </div>
       <div class="checkbox">
        <input checked="" id="textCampaignOptIn" name="textCampaignOptIn" type="checkbox"/>
        <label for="textCampaignOptIn" style="display:none">
         <span>
          <i class="fas fa-check">
          </i>
         </span>
         Wish to receive marketing materials from time to time via SMS
        </label>
        <input checked="" id="optIn" name="optIn" type="checkbox"/>
        <label for="optIn">
         <span>
          <i class="fas fa-check">
          </i>
         </span>
         Please keep me informed about future offers.
        </label>
        <input id="optPolicy" name="optPolicy" onchange="enableRegisterButton()" type="checkbox"/>
        <label for="optPolicy">
         <span>
          <i class="fas fa-check">
          </i>
         </span>
         I accept the
         <a href="/privacypolicy" target="_blank">
          Privacy Policy
         </a>
         .
        </label>
       </div>
       <div class="row">
        <div class="col-md-12">
         <button class="button button-green transition bt-full disabled" id="registerButton" type="submit">
          <img alt="loading icon" class="loading-ico animated rotateIn" src="/images/loading.svg"/>
          <span>
           Submit
          </span>
         </button>
        </div>
       </div>
       <div class="error-message">
        <i aria-hidden="true" class="fas fa-exclamation-circle">
        </i>
        <span>
         Sorry, there’s been a connection error, please try again and let us know if the problem persists
        </span>
       </div>
      </form>
      <br/>
     </div>
     <div class="modal-body col-md-12 row done register">
      <div class="col-md-12">
       <h1 id="registerSuccess">
        You are now our MVP!
       </h1>
       <button class="button button-green transition bt-full" data-dismiss="modal" onclick="closeModalAndLogin()" type="button">
        Continue
       </button>
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL LOGIN -->
  <div aria-labelledby="modalLoginLabel" class="modal fade" id="modalLogin" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <img alt="holiday bonus gift card" class="modal-header-image" src="/images/GiftCardBonus2025.jpeg">
      <div class="modal-header">
       <br>
        <h4 class="modal-title">
         Login to your MVP account
        </h4>
        <button aria-label="Close" class="close" data-dismiss="modal" type="button">
         <span aria-hidden="true">
          ×
         </span>
        </button>
       </br>
      </div>
      <div class="mvp-login-form modal-body">
       <!-- <h1></h1> -->
       <form id="modalLoginForm">
        <div class="row">
         <div class="form-group col-xs-12 col-md-12">
          <input class="form-control" id="loginModal" name="loginModal" placeholder="Username" type="text"/>
         </div>
         <div class="form-group col-xs-12 col-md-12">
          <input class="form-control" id="passwordModal" name="passwordModal" placeholder="Password" type="password"/>
         </div>
         <div class="checkbox col-xs-12 col-md-12">
          <input id="rememberMe" name="check-group-1" type="checkbox">
           <label for="rememberMe">
            Remember Me
            <span>
             <i class="fas fa-check">
             </i>
            </span>
           </label>
          </input>
         </div>
         <div class="googleRecaptcha">
          <div class="g-recaptcha" id="ModalLoginRecaptcha">
          </div>
         </div>
         <label class="fade in error-message center-block" for="loginModal" id="recaptchaModalLogin-error">
         </label>
        </div>
        <div class="row">
         <div class="error-message">
          <i aria-hidden="true" class="fas fa-exclamation-circle">
          </i>
          <span>
           Sorry, there’s been a connection error, please try again and let us know if the problem persists
          </span>
         </div>
        </div>
        <div class="row">
         <div class="col-md-12">
          <button class="button button-yellow transition bt-full" id="buttonLoginModal" type="submit">
           <img alt="loading icon" class="loading-ico animated rotateIn" src="/images/loading.svg"/>
           <span>
            Login
           </span>
          </button>
         </div>
        </div>
        <div class="row">
         <div class="col-md-6">
          <!-- <button type="button" class="button button-green transition bt-full btn-small" data-dismiss="modal" data-toggle='modal' data-target='#modalRestorePassword'>Forgot Username or Password?</button> -->
          <a class="button button-green transition bt-full btn-small" href="https://duffysmvp.myguestaccount.com/guest/forgot-password" target="_blank">
           Forgot Your
           <br/>
           Password?
          </a>
         </div>
         <div class="col-md-6">
          <button class="button button-light-green btn-small transition bt-full" data-dismiss="modal" id="buttonSignUpFree" onclick="openRegisterFromLogin()" style="padding-top: 15px; padding-bottom: 15px;" type="button">
           Not a member?  Sign up free
          </button>
         </div>
        </div>
        <div class="row">
         <div class="col-md-12" style="text-align: center;">
          <a data-dismiss="modal" href="#" id="buttonGuestLoginModal" style="text-decoration: none; font-weight: 400;">
           Continue as a guest
          </a>
         </div>
         <div class="col-md-12" style="text-align: center;">
         </div>
        </div>
        <script type="text/javascript">
         function openRegisterFromLogin() {
                                loadStores(false);
                                $('#modalLogin').off('hidden.bs.modal').on('hidden.bs.modal', function () {
                                    // do something…
                                    $('#modalRegister').modal("show");
                                    initFormRegister();
                                })
                                $('#modalLogin').modal("hide");

                            }
        </script>
       </form>
      </div>
     </img>
    </div>
   </div>
  </div>
  <!-- MODAL GIFT CARDS -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalGiftCards" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content custom-modal">
     <div class="modal-header">
      <h4 class="modal-title">
       Check your Card Balance
      </h4>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <div class="mvp-login-form gift-card-check-balance modal-body">
      <img alt="Duffy’s Card" src="/images/gift-cards.png"/>
      <!-- <h1></h1>
                                <p></p> -->
      <form id="checkBalanceForm">
       <hr/>
       <div class="form-group">
        <input class="form-control" id="cardNumber" name="cardNumber" placeholder="Card number" type="text">
        </input>
       </div>
       <div class="form-group">
        <input class="form-control" id="cardRegCode" name="cardRegCode" placeholder="Reg code" type="text">
        </input>
       </div>
       <div class="form-group">
        <select class="form-control" id="cardType" name="Card Type">
         <option selected="" value="3">
          Gift Card
         </option>
         <option value="8">
          E-Gift Card
         </option>
         <option value="4">
          Partner Plus
         </option>
        </select>
       </div>
       <small>
        Enter just the digits in the card number. Do not include any spaces.
       </small>
       <div class="error-message">
        <i aria-hidden="true" class="fas fa-exclamation-circle">
        </i>
        <span>
         Sorry, there’s been a connection error, please try again and let us know if the problem persists
        </span>
       </div>
       <div class="googleRecaptcha">
        <div class="g-recaptcha" id="checkBalanceRecaptcha">
        </div>
       </div>
       <div class="row">
        <div class="col-md-12">
         <button class="button button-green transition bt-full" id="checkBalanceButton" onclick="checkCardBalance()" type="button">
          <img alt="loading icon" class="loading-ico animated rotateIn" src="/images/loading.svg"/>
          <span>
           Check Balance
          </span>
         </button>
        </div>
       </div>
      </form>
     </div>
     <div class="mvp-login-form gift-card-balance">
      <img alt="Duffy’s Card" src="/images/gift-cards.png"/>
      <h1>
       Your Card Balance is:
      </h1>
      <div class="card-balance-cont">
       <h2 class="card-balance">
       </h2>
       <!-- <ul class="card-balance-list"> -->
       <!-- <li>
                        <span>$5</span><span class="card-reward-name">Reward Name</span> expires on <span>05/11/2017</span>.
                        </li>
                        <li>
                        <span>$15</span><span class="card-reward-name">Reward Name Long Name</span> expires on <span>05/11/2017</span>.
                        </li>
                        <li>
                        <span>$5</span><span class="card-reward-name">Reward Name Very Long Name</span> expires on <span>05/11/2017</span>.
                        </li>
                        <li>
                        <span>$50</span><span class="card-reward-name">Reward</span> expires on <span>05/11/2017</span>.
                        </li> -->
       <!-- </ul> -->
      </div>
      <div class="row">
       <div class="col-md-12">
        <button class="button button-green transition bt-full" onclick="resetBalanceModal()" type="button">
         Check the balance of another card
        </button>
       </div>
      </div>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL promo COUPONS -->
  <div aria-labelledby="myModalLabelCoupon" class="modal fade" id="modalCoupons" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <h4 class="modal-title" id="myModalLabelCoupon">
       Redeem a Promo Code
      </h4>
     </div>
     <div class="modal-body">
      <div class="address-search-container">
       <div class="input-group">
        <label for="">
        </label>
        <input class="form-control" id="txtCoupon" placeholder="Enter promo code" type="text"/>
        <button class="button button-green" onclick="verifyCoupon()" type="button">
         <img alt="" class="loading-ico animated rotateIn" src="/images/loading.svg"/>
         <span>
          Check coupon
         </span>
        </button>
       </div>
      </div>
      <div class="rewards-buttons-container">
       <div class="reward-button">
        <div class="reward-image">
         <img alt="Duffy’s Coupon" src="/images/coupon.png"/>
        </div>
        <div class="reward-button-text">
         <h3>
         </h3>
         <p>
         </p>
        </div>
       </div>
      </div>
     </div>
     <div class="modal-footer">
      <button class="button button-green button-light" data-dismiss="modal">
       Cancel
      </button>
      <button class="button button-green" id="btnCouponApply" onclick="appliedCouponDiscount()">
       Apply Coupon
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL PICKUP LOCATION -->
  <div aria-labelledby="myModalLabel" class="modal fade" id="modalLocation" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
      <h4 class="modal-title" id="myModalLabel">
       Choose your Pick Up Location
      </h4>
     </div>
     <div class="modal-body">
      <div class="location-card-list" id="location-card-list">
      </div>
     </div>
     <div class="modal-footer">
      <button class="btn btn-primary" data-dismiss="modal" type="button">
       Accept Location
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- MODAL PRODUCT OPTIONS -->
  <div aria-labelledby="myModalLabel" class="modal modal-product fade" id="modalOptionsProduct" role="dialog" tabindex="-1">
   <div class="modal-dialog" role="document">
    <div class="modal-content">
     <div class="modal-header">
      <div class="beta-advice">
       <h1>
        ONLINE ORDERING
       </h1>
      </div>
      <div class="menu-product-description">
       <div class="menu-product-desc">
        <i id="icon-modal">
        </i>
        <h4 class="menu-product-title">
        </h4>
       </div>
       <div class="menu-product-info">
        <div class="info product-price">
        </div>
        <div class="info product-calories">
        </div>
       </div>
      </div>
      <button aria-label="Close" class="close" data-dismiss="modal" type="button">
       <span aria-hidden="true">
        ×
       </span>
      </button>
     </div>
     <div class="modal-body">
     </div>
     <div class="modal-footer">
      <button class="button button-light button-green" data-dismiss="modal" type="button">
       Cancel
      </button>
      <button class="button button-green" id="addProductButton" onclick="addProductToCart()" type="button">
       Add for
       <span id="addButtonPrice">
       </span>
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- ======================================================================================
                                            NAVBAR
         ====================================================================================== -->
  <nav class="navbar transition animated fadeInDown">
   <div class="container-fluid">
    <div class="navbar-header">
     <button class="navbar-toggle collapsed" id="mobileNavBarButton" type="button">
      <span class="sr-only">
       Toggle navigation
      </span>
      <span class="icon-bar">
      </span>
      <span class="icon-bar">
      </span>
      <span class="icon-bar">
      </span>
     </button>
     <button class="navbar-toggle collapsed" id="mobileCartButton" type="button">
      <span class="sr-only">
       Toggle navigation
      </span>
      <span class="icon-bag">
      </span>
      <div class="badge cart-length-mobile animated bounce">
       0
      </div>
     </button>
     <a class="navbar-brand" href="../Default.aspx" id="lnkLogo" style=" background-image: url('https://api.duffysmvp.com/img/imagesLogo/359edf43-c34c-4d33-a689-4782c8297a1f.png');">
     </a>
    </div>
    <div class="collapse navbar-collapse" id="navbar-menu">
     <ul class="nav navbar-nav navbar-right navbar-sections">
      <li class="menu-links">
       <a href="/menu" target="_self">
        MENU
       </a>
      </li>
      <li class="menu-links">
       <a href="/events/" target="_self">
        EVENTS
       </a>
      </li>
      <li class="menu-links">
       <a href='javascript: openSubMenu("menu-category.aspx?name=party-platters", "62")' target="_self">
        PARTY PLATTERS
       </a>
      </li>
      <li class="menu-links">
       <a href="/locations" target="_self">
        LOCATIONS
       </a>
      </li>
      <li class="menu-links">
       <a href="/mvp" target="_self">
        MVP
       </a>
      </li>
      <li class="menu-links">
       <a href="/aboutus" target="_self">
        ABOUT
       </a>
      </li>
      <li class="menu-links">
       <a href="/giftcards" target="_self">
        GIFT CARDS
       </a>
      </li>
      <li class="menu-links">
       <a href="/careers" target="_self">
        Careers
       </a>
      </li>
      <li class="menu-links">
       <a href="javascript:goToPayOnline();" target="_self">
        ORDER ONLINE
       </a>
      </li>
      <li>
       <div class="dropdown">
        <button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" id="dLabel" type="button">
         <!-- <i class="fas fa-bars"></i> -->
         <span class="icon-bag">
         </span>
         <div class="badge cart-length animated bounce">
          0
         </div>
        </button>
        <ul aria-labelledby="dLabel" class="dropdown-menu">
         <div class="dropdown-personal logged not-logged">
          <div class="logged-content">
           <a class="user-content" href="/mvp">
            <img alt="" class="img-circle user" src=""/>
            <div class="user-data">
             <div class="user-name">
              <i class="fas fa-chevron-right">
              </i>
             </div>
             <div class="dropdown-points">
              <span class="money">
              </span>
              |
              <span class="points">
              </span>
             </div>
            </div>
           </a>
           <a class="button" href="#" onclick="app.utils.deleteCookies(true)">
            Log out
           </a>
          </div>
          <div class="not-logged-content">
           <p>
            You are not logged in.
           </p>
           <a class="button" href="/mvp">
            Sign In
           </a>
          </div>
         </div>
         <div class="dropdown-cart cart">
          <div class="row beta-advice">
           <h1>
            ONLINE ORDERING
           </h1>
          </div>
          <h4>
           My Order
          </h4>
          <div class="no-items">
           Your Bag is empty
          </div>
          <div class="cart-content">
          </div>
          <div class="cart-total">
           Subtotal:
           <b class="totalPriceMenu">
            $0
           </b>
          </div>
          <p class="advice" id="deliveryAdvice">
          </p>
          <a class="button cart-menu hidden" href="/cart.aspx">
           View Bag | Checkout
          </a>
          <a class="button go-to-menu hidden" href="/menu">
           Start your order
          </a>
         </div>
        </ul>
       </div>
      </li>
     </ul>
    </div>
    <div aria-labelledby="dLabel" class="dropdown-menu">
    </div>
   </div>
  </nav>
  <!-- Button trigger modal -->
  <!-- <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#modalBracket">
    Launch demo modal
  </button> -->
  <div class="container-fluid header-section header-menu" id="ContentPlaceHolder1_divBackgroundHeader" style=" background-image: url('https://api.duffysmvp.com/img/imagesMenu/822f4b48-4d8e-466b-8b67-b326523bb567.jpg');">
   <div class="container header-container">
    <div class="row header-claim">
     <h1 class="animated fadeInUp">
      Steaks, Chops, Seafood &amp; Pasta
     </h1>
    </div>
    <div class="row header-footer animated fadeInUp">
     <div class="header-footer-actions">
      <!-- <div class="action action-left">
                                <a href="/pdf/partyPlannerMenu-Duffys.pdf" target="_blank">Download Party Platter Menu
                                    <i class="fas fa-angle-down" aria-hidden="true"></i>
                                </a>
                            </div> -->
      <!-- <div class="action">
                                <a href="/pdf/duffys-nutritional-guide.pdf" target="_blank">Download Nutritional Guide
                                    <i class="fas fa-angle-down" aria-hidden="true"></i>
                                </a>
                            </div> -->
      <div class="action">
       <a href="/pdf/duffysmenu.pdf" target="_blank">
        Download Duffy's Menu
        <i aria-hidden="true" class="fas fa-angle-down">
        </i>
       </a>
      </div>
     </div>
    </div>
   </div>
   <div class="header-bottom-gradient">
   </div>
  </div>
  <div class="container">
   <div class="owl-carousel menu-carousel owl-theme carousel-yellow-arrows">
    <div class="menu-item" data-hash="1">
     <a class="menu-item-content item-1" onclick="openSubMenu('menu-category.aspx?name=starters', '1')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-chips">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Starters
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="14">
     <a class="menu-item-content item-14" onclick="openSubMenu('menu-category.aspx?name=salads', '14')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-salads">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Salads
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="122">
     <a class="menu-item-content item-122" onclick="openSubMenu('menu-category.aspx?name=soups', '122')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-soup">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Soups
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="169">
     <a class="menu-item-content item-169" onclick="openSubMenu('menu-category.aspx?name=triple-tacos', '169')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-taco">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Triple Tacos
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="126">
     <a class="menu-item-content item-126" onclick="openSubMenu('menu-category.aspx?name=drafthouse-favorites', '126')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-sauce">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Drafthouse Favorites
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="17">
     <a class="menu-item-content item-17" onclick="openSubMenu('menu-category.aspx?name=award-winning-burgers', '17')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-burger">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Award-Winning Burgers
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="172">
     <a class="menu-item-content item-172" onclick="openSubMenu('menu-category.aspx?name=award-winning-wings', '172')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-wings">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Award-Winning Wings
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="15">
     <a class="menu-item-content item-15" onclick="openSubMenu('menu-category.aspx?name=bbq-ribs', '15')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-hot">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        BBQ Ribs
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="175">
     <a class="menu-item-content item-175" onclick="openSubMenu('menu-category.aspx?name=rice-bowls', '175')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-duffys">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Rice Bowls
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="16">
     <a class="menu-item-content item-16" onclick="openSubMenu('menu-category.aspx?name=sandwiches', '16')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-sandwich">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Sandwiches
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="8">
     <a class="menu-item-content item-8" onclick="openSubMenu('menu-category.aspx?name=steaks-chops-seafood--pasta', '8')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-grill">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Steaks, Chops, Seafood &amp; Pasta
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="18">
     <a class="menu-item-content item-18" onclick="openSubMenu('menu-category.aspx?name=features', '18')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-features">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Features
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="19">
     <a class="menu-item-content item-19" onclick="openSubMenu('menu-category.aspx?name=lunch-specials', '19')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-lunchspecials">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Lunch Specials
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="22">
     <a class="menu-item-content item-22" onclick="openSubMenu('menu-category.aspx?name=kids', '22')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-kids">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Kids
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="23">
     <a class="menu-item-content item-23" onclick="openSubMenu('menu-category.aspx?name=desserts', '23')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-dessert">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Desserts
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="72">
     <a class="menu-item-content item-72" onclick="openSubMenu('menu-category.aspx?name=sides', '72')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-french-fries">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Sides
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="62">
     <a class="menu-item-content item-62" onclick="openSubMenu('menu-category.aspx?name=party-platters', '62')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-bag">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Party Platters
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="67">
     <a class="menu-item-content item-67" onclick="openSubMenu('menu-category.aspx?name=beverages', '67')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-drink">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Beverages
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="107">
     <a class="menu-item-content item-107" onclick="openSubMenu('menu-category.aspx?name=beer', '107')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-pint">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Beer
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="109">
     <a class="menu-item-content item-109" onclick="openSubMenu('menu-category.aspx?name=wine', '109')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-wine">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Wine
       </p>
      </div>
     </a>
    </div>
    <div class="menu-item" data-hash="105">
     <a class="menu-item-content item-105" onclick="openSubMenu('menu-category.aspx?name=cocktails', '105')" target="_self">
      <div class="menu-item-icon">
       <span class="icon-thebar">
       </span>
      </div>
      <div class="menu-item-caption">
       <p>
        Cocktails
       </p>
      </div>
     </a>
    </div>
   </div>
  </div>
  <!-- 
        <div class="container menu-choose-subcategory">
            <div class="subcategory-container">
                <a href="#" class="subcategory-item">
                    <h2>HOME PLATE</h2>
                    <p>Pick and choose between one of our special plates that we cook daily.</p>
                    <p class="note">Avalaible weekdays until 4pm. Cannot be combined with MVP Afternoon Break or any other discount.</p>
                </a>
                <div class="separator"></div>

                <a href="#" class="subcategory-item">
                    <h2>DOUBLE PLAY</h2>
                    <p>Pick and combine two plates between:</p>
                            <ul>
                                <li>Soup and a Salad</li>
                                <li>1/2 Sandwich and a Salad</li>
                                <li>1/2 Sandwich and a Soup.</li>
                            </ul>
                    
                    <p class="note">Avalaible weekdays until 4pm. Cannot be combined with MVP Afternoon Break or any other discount.</p>
                </a>
            </div>
        </div>
   

    <div class="container menu-choose-subcategory">
        <div class="subcategory-title">
            <h2>DOUBLE PLAY</h2>
            <p>Pick any two</p>
        </div>
            
        <div class="subcategory-container">
            <a href="#" class="subcategory-item">
                <h3>Soup & Salad</h3>
                <p class="price">$6.99</p>
            </a>

            <div class="separator"></div>
    
            <a href="#" class="subcategory-item">
                <h3>1/2 Sandwich & Salad</h3>
                <p class="price">$6.99</p>
            </a>

            <div class="separator"></div>
            <a href="#" class="subcategory-item">
                    <h3>1/2 Sandwich & Soup</h3>
                    <p class="price">$7.99</p>
                </a>
            </div>
        </div> -->
  <div class="container menu-products-container">
   <input id="categoryId" type="hidden" value="8"/>
   <input id="hidCategoryUrlf" type="hidden" value="menu-category.aspx?name=steaks-chops-seafood--pasta">
    <div class="menu-products-subheader">
     STEAKS, CHOPS, SEAFOOD &amp; PASTA
    </div>
    <div class="menu-products-list">
     <div class="menu-product is-new">
      <div class="menu-product-description">
       <div class="product-title-container">
        <h4 id="name665736">
         New York Strip Steak*
        </h4>
       </div>
       <p id="description665736">
        12oz USDA Choice center-cut aged 28 days. Includes choice of two sides.
       </p>
       <div class="labels-container">
        <img alt="" src="https://api.duffysmvp.com/img/imagesLables/dbd082eb-0855-422d-a2b1-8f2222a842bd.png"/>
       </div>
       <span id="ContentPlaceHolder1_lvSubCategories_lvMenuItems_0_ctrl0_0_lbComment_0">
       </span>
      </div>
      <div class="menu-product-actions">
       <p class="calories">
        (cal 880)
       </p>
       <button class="add-button menu-category" name="button" onclick="goToPayOnline($('#hidCategoryUrlf').val())" type="button">
        <i class="icon-bag">
        </i>
       </button>
      </div>
     </div>
     <div class="menu-product is-new">
      <div class="menu-product-description">
       <div class="product-title-container">
        <h4 id="name665236">
         Center Cut Pork Chops
        </h4>
       </div>
       <p id="description665236">
        Two 5oz premium boneless pork chops. Includes choice of two sides.
       </p>
       <span id="ContentPlaceHolder1_lvSubCategories_lvMenuItems_0_ctrl0_0_lbComment_1">
       </span>
      </div>
      <div class="menu-product-actions">
       <p class="calories">
        (cal 480)
       </p>
       <button class="add-button menu-category" name="button" onclick="goToPayOnline($('#hidCategoryUrlf').val())" type="button">
        <i class="icon-bag">
        </i>
       </button>
      </div>
     </div>
     <div class="menu-product is-new">
      <div class="menu-product-description">
       <div class="product-title-container">
        <h4 id="name242736">
         Grilled Salmon
        </h4>
       </div>
       <p id="description242736">
        8oz fillet, rich and flavorful. Includes choice of two sides.
       </p>
       <span id="ContentPlaceHolder1_lvSubCategories_lvMenuItems_0_ctrl1_0_lbComment_2">
       </span>
      </div>
      <div class="menu-product-actions">
       <p class="calories">
        (cal 390)
       </p>
       <button class="add-button menu-category" name="button" onclick="goToPayOnline($('#hidCategoryUrlf').val())" type="button">
        <i class="icon-bag">
        </i>
       </button>
      </div>
     </div>
     <div class="menu-product is-new">
      <div class="menu-product-description">
       <div class="product-title-container">
        <h4 id="name660536">
         Blackened Mahi Mahi
        </h4>
       </div>
       <p id="description660536">
        8oz fillet, firm in texture, mild in flavor. Includes choice of two sides.
       </p>
       <span id="ContentPlaceHolder1_lvSubCategories_lvMenuItems_0_ctrl1_0_lbComment_3">
       </span>
      </div>
      <div class="menu-product-actions">
       <p class="calories">
        (cal 260)
       </p>
       <button class="add-button menu-category" name="button" onclick="goToPayOnline($('#hidCategoryUrlf').val())" type="button">
        <i class="icon-bag">
        </i>
       </button>
      </div>
     </div>
     <div class="menu-product is-new">
      <div class="menu-product-description">
       <div class="product-title-container">
        <h4 id="name423936">
         Shrimp Scampi
        </h4>
       </div>
       <p id="description423936">
        Jumbo shrimp, angel hair spaghetti, white wine garlic butter, aged parmesan, served with garlic bread.
       </p>
       <span id="ContentPlaceHolder1_lvSubCategories_lvMenuItems_0_ctrl2_0_lbComment_4">
       </span>
      </div>
      <div class="menu-product-actions">
       <p class="calories">
        (cal 1720)
       </p>
       <button class="add-button menu-category" name="button" onclick="goToPayOnline($('#hidCategoryUrlf').val())" type="button">
        <i class="icon-bag">
        </i>
       </button>
      </div>
     </div>
     <div class="menu-product is-new">
      <div class="menu-product-description">
       <div class="product-title-container">
        <h4 id="name675236">
         Cajun Chicken Fettuccine Alfredo
        </h4>
       </div>
       <p id="description675236">
        Blackened chicken breast, fettuccine pasta, vine ripened tomato, butter cream sauce, aged parmesan, scallion, served with garlic bread.
       </p>
       <span id="ContentPlaceHolder1_lvSubCategories_lvMenuItems_0_ctrl2_0_lbComment_5">
       </span>
      </div>
      <div class="menu-product-actions">
       <p class="calories">
        (cal 1970)
       </p>
       <button class="add-button menu-category" name="button" onclick="goToPayOnline($('#hidCategoryUrlf').val())" type="button">
        <i class="icon-bag">
        </i>
       </button>
      </div>
     </div>
    </div>
   </input>
  </div>
  <div class="container menu-toppings-container">
   <div class="row load-more-social">
    <img alt="Duffys menu legend" src="/images/Duffys-Menu-Legend.png" style="width:100%">
    </img>
   </div>
   <!--  <div class="row text-center">
                 
                      <a id="ContentPlaceHolder1_hlnkNutritionalGuide" class="button button-small button-green" href="https://api.duffysmvp.com//pdf/Nutritional-Guide.pdf" target="_blank">Download Nutritional Guide
                
            </a>
                </div> -->
  </div>
  <div class="row load-more-social">
   <a class="load-more-button" href="/menu">
    BACK TO MENU
   </a>
  </div>
  <div class="container-fluid rewards-interior-section">
   <div class="container">
    <div class="col">
     <h3>
      start earning rewards now
     </h3>
    </div>
    <a class="button-claim btn-yellow transition animated fadeInLeft" href="/mvp">
     <span>
      Login to MVP
     </span>
     <div class="button-arrow">
     </div>
     <hr class="transition"/>
    </a>
   </div>
  </div>
  <script>
   var currentOptions = {};
                var currentCollapse = '';
                var inv_num;
                var scr_num;
                var cell_num;
                var nameProduct;
                var iconClass;
                var masterItemName;
                var userLat;
                var userLong;
                var maxlength = 45;


   
    

                $(function () {
                    //app.main.checkDeliveryStatus();
                    app.main.loadStorage('menuCart');

                    checkCategoryAvailable();

                    app.utils.getPosition(function (lat, long) {
                        userLat = lat;
                        userLong = long;
                    })
                    if (!app.globals.OLOActived) {
                        $('.add-button').hide();
                    } else {
                        if (app.globals.menuCart.OloType && app.globals.menuCart.OloType != null) {
                            console.log(app.globals.menuCart.storeId);
                        if (app.globals.menuCart.OloType == 'delivery') {
                           $("#current-location .text").html("<p>Delivery to</p> <p class=\"location\">"+app.globals.menuCart.delivery.address+"</p>");
                            $('#btnchangelocation').hide();
                        } 
                    }
                        

                    
                               
                    }

                    $('.item-' + $('#categoryId').val()).addClass('active');

                    app.main.loadStorage('menuCart');
                    countProducts();
                    $('.cart-content').on('menuCart:updated', function (event) {
                        countProducts();
                    });
                    $('.add-button.class-btAdd').on('click', function (event) {
                        var element = jQuery(this);
                        inv_num = element.data('inv_num');
                        scr_num = element.data('scr_num');
                        iconClass = element.data('iconclass');
                        cell_num = element.data('cell_num');
                        nameProduct = element.data('name');
                        masterItemName = element.data('masterName');
                        app.ajax.getInitialConfiguration(function (resConfig) {
  //hubo un cambio en el método de getInitialConfiguration del back, y se añadieron nodos nuevos al json que se devuelve. Para adaptar esta función que estamos ejecutando solo nos interesa el nodo que se llama OLO
                for (var i = 0; i < resConfig.length; i++) {
                    if (resConfig[i].item == "OLO") {
                        resConfig = resConfig[i];  
                    }
                }
                            if (resConfig.value) {
                                if (app.globals.menuCart.orderTime && app.globals.menuCart.storeId) {
                                    app.main.showLoadingModal();
                                    app.ajax.getProductOptions(inv_num, scr_num, function (res) {
                                        app.main.hideLoadingModal();
                                        currentOptions = res;
                                        currentOptions['inv_num'] = inv_num;
                                        currentOptions['scr_num'] = scr_num;
                                        currentOptions['cell_num'] = cell_num;
                                        currentOptions['name'] = element.data('name');
                                        if (masterItemName !== '') {
                                            currentOptions['name'] = masterItemName + ' - ' + currentOptions['name'];
                                        }
                                        generateModalContent(res, inv_num, scr_num);
                                        $('#modalLoading').on('hidden.bs.modal', function () {
                                            $('#modalLoading').off('hidden.bs.modal');
                                            $('#modalOptionsProduct').modal('show');
                                            
                                        })
                                    }, function (err) {
                                        app.main.hideLoadingModal();
                                        app.utils.showErrorMessage("",err.responseJSON.message);
                                        console.log(err);
                                    })
                                } else {
                                    app.main.showLoadingModal();
                                    app.ajax.storeName(function (data) {
                                        app.globals.storesCheck = data;
                                        app.main.updateStorage('storesCheck');
                                        app.main.hideLoadingModal();
                                        $('#modalLoading').on('hidden.bs.modal', function () {
                                            if (!app.globals.menuCart.orderTime && !app.globals.menuCart.storeId && !app.globals.menuCart.OloType=='delivery') {
                                                showModalStore(data);
                                            }
                                        });
                                    }, function (err) {
                                        app.main.hideLoadingModal();
                                        app.utils.showErrorMessage("",err.responseJSON.message);
                                        console.log("ERR", err) // TODO
                                    });
                                }
                            } else {
                                showModalBefore9(resConfig);
                            }
                        }, function (err) {
                             console.log("err", err);
                        })
                    });


                    

                    
                });


              

                
              


                function countProducts() {
                    var addButtons = $('.add-button');
                    for (var index = 0; index < addButtons.length; index++) {
                        var addButton = jQuery(addButtons[index]);
                        var inv_num = addButton.data('inv_num');
                        var scr_num = addButton.data('scr_num');
                        var productsInCart = 0;
                        for (var ind = 0; ind < app.globals.menuCart.items.length; ind++) {
                            var product = app.globals.menuCart.items[ind];
                            if (product.inv_num === inv_num && product.scr_num === scr_num) {
                                productsInCart += product.count;
                            }
                        }
                        if (productsInCart !== 0) {
                            addButton.find('.badge').text(productsInCart);
                            addButton.find('.badge').removeClass('hidden');
                        } else {
                            addButton.find('.badge').addClass('hidden');
                        }
                    }
                }



                function generateModalContent(options, inv_num, scr_num) {
                    /* console.log('numero de opciones: ' + options.length)
                    console.log(options) */
                    app.utils.sendAnalytics('menu', 'item', inv_num);
                    var modal = $("#modalOptionsProduct");
                    modal.find('.modal-body').html('');
                    var productPrice = $('#price' + inv_num + scr_num).text();
                    var productCalories = $('#price' + inv_num + scr_num).attr("data-calories");
                    var productName = $('#name' + inv_num + scr_num).text();
                    if (masterItemName !== '') {
                        productName = masterItemName + ' - ' + productName;
                    }
                    var productDescription = $('#description' + inv_num + scr_num).text();
                    modal.find('#icon-modal').addClass(iconClass);
                    modal.find('.menu-product-description h4').html(productName);
                    modal.find('.menu-product-description').find(".menu-product-info").find(".product-price").html(productPrice);
                    if ((productCalories.length) > 0) {
                        modal.find('.menu-product-description').find(".menu-product-info").find(".product-calories").html("(cal " + productCalories + ")");
                    }
                    
                    modal.find('.menu-product-description p').text(productDescription);
                    for (var index = 0; index < options.length; index++) {
                        var topping = options[index];
                        var inputType = void 0;
                        var toppingsMessage = void 0;
                        var required = false;
                        currentOptions[index].toppingsMessage = '';
                        switch (topping.typeId) {
                            case "0":
                                // 0 - Must Select (OBLIGATORIO) Pero multiple o radio?
                                inputType = 'radio';
                                required = true;
                                // currentOptions[index].toppingsMessage = 'Choose One';
                                break;
                            case "1":
                                // 1 - May Select - Multip (OPCIONAL MÚLTIPLE)
                                // currentOptions[index].toppingsMessage = 'Optional';
                                inputType = 'checkbox';
                                break;
                            case "2":
                                // 2 - May Select - Exclus (OPCIONAL EXCLUSIVO)
                                // currentOptions[index].toppingsMessage = 'Optional';
                                inputType = 'radio';
                                break;
                            case "3":
                                // 3 - May Select - Single (OPCIONAL SIMPLE)
                                // currentOptions[index].toppingsMessage = 'Optional';
                                inputType = 'checkbox';
                                break;
                            default:
                                break;
                        }
                        // ${topping.typeId === '0' ? '<span class="has-error required-' + index + ' hidden"><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> You must select at least one</span>' : ''}
                        var toppingHtml = '<div class="options type-' + topping.typeId + ' ' + (topping.typeId === '3' ? 'hidden' : '') + '">'
                        toppingHtml += '<div class="title" onclick="controlCollapse(\'' + (topping.name.replace(/&|\+/g, "_").replace(/ /g, "_") + topping.opt_scr_num + topping.opt_scr_seq + topping.typeId) + '\',\'' + topping.typeId + '\')"><i class="fas fa-fire"></i>';
                        toppingHtml += topping.name
                        toppingHtml += '    <p class="selected-options ' + (topping.typeId === '0' ? 'required-' + index : '') + '" id="' + (topping.name.replace(/&|\+/g, "_").replace(/ /g, "_") + topping.opt_scr_num + topping.opt_scr_seq + topping.typeId) + '-selected"><i class="fas fa-exclamation-triangle hidden" aria-hidden="true"></i>' + currentOptions[index].toppingsMessage + '</p>';
                        toppingHtml += '</div>';
                        toppingHtml += '<div class="collapse options-container-mask" id="' + (topping.name.replace(/&|\+/g, "_").replace(/ /g, "_") + topping.opt_scr_num + topping.opt_scr_seq + topping.typeId) + '">';
                        toppingHtml += '    <div class="options-container">';
                        for (var ind = 0; ind < topping.options.length; ind++) {
                            var option = topping.options[ind];
                            if (option.price !== "0") {
                                option.price = option.price.substr(0, option.price.length - 2) + '.' + option.price.substr(option.price.length - 2);
                            }
                            toppingHtml += '    <div class="option">';
                            toppingHtml += '<input type="' + inputType + '" onchange="collapseAndRecalculate(' + (inputType === "radio" ? true : false) + ', ' + index + ')"';
                            toppingHtml += ' id="' + (inputType + option.inv_num + '-' + option.scr_num + option.cell_num + topping.opt_scr_seq) + '"';
                            toppingHtml += ' name="group-' + index + currentOptions.scr_num + '"';
                            toppingHtml += ' value="' + option.name + '" ' + (required ? 'required' : '') + '';
                            toppingHtml += ' ' + (option.price === '0' ? '' : 'data-price=' + option.price) + ' ';
                            toppingHtml += ' data-option-index=\'' + index + '\' data-topping-index=\'' + ind + '\'';
                            toppingHtml += '/>';
                            toppingHtml += '<label for="' + (inputType + option.inv_num + '-' + option.scr_num + option.cell_num + topping.opt_scr_seq) + '">';
                            toppingHtml += '' + option.name + '';
                            toppingHtml += '<div class="info"><div class="price">' + (option.price === '0' ? '' : '$' + option.price) + '</div>';
                            toppingHtml += '<div class="calories">' + ((option.calories.length) > 0 ? '(cal ' + option.calories + ')' : '') + '</div></div>';
                            toppingHtml += '<span><i class="fas fa-check"></i></span>';
                            toppingHtml += '</label>';
                            toppingHtml += '</div>';
                        }
                        toppingHtml += '\n                                        </div>\n                                    </div>\n                                </div>';
                        modal.find('.modal-body').append(toppingHtml);
                    }
                    var textArea = '<div class="options">';
                    textArea += '    <div class="title"><i class="fas fa-fire"></i>';
                    textArea += '        Special Instructions <p class="selected-options ">45 Characters or Less</p>';
                    textArea += '                        </div>';
                    textArea += '    <div class=" options-container-mask" id="textarea">';
                    textArea += '        <div class="options-container"> <span class="counter-input">45</span>';
                    textArea += '            <textarea id="text-area" maxlength="45" rows="1" onKeyUp="countLength(event)" onKeyDown="checkInvalidChar()"></textarea>';
                    textArea += '        </div>';
                    textArea += '    </div>';
                    textArea += '</div>';
                    modal.find('.modal-body').append(textArea);
                    reCalculatePrice(false);
                    if (options.length > 0) {
                        controlCollapse(options[0].name.replace(/&|\+/g, "_").replace(/ /g, "_") + options[0].opt_scr_num + options[0].opt_scr_seq + options[0].typeId, options[0].typeId);
                    }

                }


                function countLength(event) {
                    testLength(event.target);
                }

                function testLength(ta) {
                    if(ta.value.length > maxlength) {
                        console.log('**********: ', event.target.value);
                        $('#text-area').val(ta.value.substring(0, maxlength));
                    }else{
                        var length = event.target.value.length;
                        var length = maxlength-length;
                        $('.counter-input').text(length);
                        if(length == 0){
                            $('.counter-input').addClass('red');
                        }else{
                            $('.counter-input').removeClass('red');
                        }
                    }
                }

                function checkInvalidChar() {
                    var e = event || window.event;  // get event object
                    var validChars = "qwertyuiopasdfghjklzxcvbnm1234567890";
                    if (validChars.indexOf(e.key.toLowerCase()) === -1 && e.key !== 'Backspace' && e.key !== 'Delete' && e.key !== ' ') { //allow backspace //and delete
                        if (e.preventDefault) e.preventDefault();
                        e.returnValue = false;
                    }
                    // if ((key < 48 || key > 57 ) || key === 8 || (key > 65 || key < 90)) { //if it is not a number ascii code
                    //Prevent default action, which is inserting character
                    //     if (e.preventDefault) e.preventDefault(); //normal browsers
                    //         e.returnValue = false; //IE
                    // }  
                }

                function addProductToCart() {
                    if (reCalculatePrice(true)) {
                        var totalPrice = 0;

                        for (var index = 0; index < currentOptions.length; index++) {
                            var option = currentOptions[index];
                            delete option.options;
                        }

                        var count = 1;

                        var productToPush = {
                            name: currentOptions.name,
                            inv_num: currentOptions.inv_num,
                            scr_num: currentOptions.scr_num,
                            cell_num: currentOptions.cell_num,
                            options: currentOptions,
                            price: $('#price' + currentOptions.inv_num + currentOptions.scr_num).data('price'),
                            calories: $('#price' + currentOptions.inv_num + currentOptions.scr_num).data('calories'),
                            totalPrice: parseFloat($('#addButtonPrice').data('price')),
                            count: 1,
                            commentOLO: $('#text-area').val()
                        };

                        if (app.globals.menuCart.items.length === 0) {
                            app.utils.sendAnalytics('OO', 'startBag', productToPush.inv_num);
                        }
                        app.utils.sendAnalytics('OO', 'addItem', productToPush.inv_num);

                        for (var index = 0; index < app.globals.menuCart.items.length; index++) {
                            var product = app.globals.menuCart.items[index];
                            var oldcount = product.count;
                            var oldPrice = product.totalPrice;
                            product['count'] = 1;
                            delete product.totalPrice;
                            delete productToPush.totalPrice;
                            if (JSON.stringify(product) === JSON.stringify(productToPush)) {
                                app.globals.menuCart.items[index].count = oldcount + 1;
                                count = product.count;
                                app.globals.menuCart.items[index].totalPrice = parseFloat((parseFloat($('#addButtonPrice').data('price')) * count).toFixed(2));
                            } else {
                                product.totalPrice = parseFloat(oldPrice);
                                product.count = oldcount;
                            }
                        }
                        productToPush['totalPrice'] = parseFloat($('#addButtonPrice').data('price')) * count;
                        if (count === 1) {
                            app.globals.menuCart.items.push(productToPush); // https://stackoverflow.com/questions/7261431/adding-items-to-an-object-through-the-push-method
                        }
                        countProducts();
                        var el = $('.' + currentOptions.inv_num + currentOptions.scr_num + currentOptions.cell_num),
                            newone = el.clone(true);
                        el.before(newone);
                        $("." + currentOptions.inv_num + currentOptions.scr_num + currentOptions.cell_num + ":last").remove();
                        removeRewarDollarApplied();
                        app.menuCart.updateCart();
                    }
                }

                function collapseAndRecalculate(collapse, index) {
                    // IGR: (&& index < currentOptions.length-1) Para que no afecte al ultimo grupo de opciones y no de error al intentar colapsar el siguiente que no existe
                    if (collapse && index < currentOptions.length - 1) {
                        controlCollapse((currentOptions[index].name.replace(/&|\+/g, "_").replace(/ /g, "_") + currentOptions[index].opt_scr_num + currentOptions[index].opt_scr_seq + currentOptions[index].typeId), currentOptions[index].typeId)
                        controlCollapse((currentOptions[index + 1].name.replace(/&|\+/g, "_").replace(/ /g, "_") + currentOptions[index + 1].opt_scr_num + currentOptions[index + 1].opt_scr_seq + currentOptions[index + 1].typeId), currentOptions[index + 1].typeId)
                    } else {
                        console.log("MENU CATEGORY");
                        // controlCollapse((currentOptions[index].name.replace(/&|\+/g, "_").replace(/ /g, "_") + currentOptions[index].opt_scr_num + currentOptions[index].opt_scr_seq + currentOptions[index].typeId), currentOptions[index].typeId)
                    }
                    reCalculatePrice(false);
                }

                function reCalculatePrice(beforeAdding) {
                    var totalPrice = parseFloat($('#price' + currentOptions.inv_num + currentOptions.scr_num).data('price')); // GET TOTAL PRICE
                    for (var index = 0; index < currentOptions.length; index++) { // Loop through the toppings
                        var topping = currentOptions[index];
                        $('#' + currentOptions[index].name.replace(/&|\+/g, "_").replace(/ /g, "_") + '-selected').html('<i class="fas fa-exclamation-triangle hidden" aria-hidden="true"></i>' + currentOptions[index].toppingsMessage); // Reset message
                        topping['optionsSelected'] = []; // Reset options selected
                        var toppingInputs = $('input[name=group-' + index + currentOptions.scr_num + ']:checked'); // Get checked inputs
                        if (toppingInputs.length === 0) { // If there is not checked inputs, reset message and return
                            $('#' + topping.name.replace(/&|\+/g, "_").replace(/ /g, "_") + topping.opt_scr_num + topping.opt_scr_seq + topping.typeId + '-selected').text(topping.toppingsMessage);
                        }

                        if (toppingInputs.length !== 0) { // If there is toppings checked
                            for (var ind = 0; ind < toppingInputs.length; ind++) { //loop through the toppings
                                // var toppingData = toppingInputs[ind].dataset;
                                var toppingIndex = toppingInputs[ind].getAttribute('data-topping-index');
                                var optionIndex = toppingInputs[ind].getAttribute('data-option-index');
                                var toppingPrice = toppingInputs[ind].getAttribute('data-price');
                                topping['optionsSelected'].push(currentOptions[optionIndex].options[toppingIndex])
                                var currentOption = currentOptions[optionIndex];
                                if (ind === 0) { // If is the first checked input, reset toppings message
                                    $('#' + currentOption.name.replace(/&|\+/g, "_").replace(/ /g, "_") + currentOption.opt_scr_num + currentOption.opt_scr_seq + currentOption.typeId + '-selected').text('');
                                }
                                // add name to toppings message
                                $('#' + currentOption.name.replace(/&|\+/g, "_").replace(/ /g, "_") + currentOption.opt_scr_num + currentOption.opt_scr_seq + currentOption.typeId + '-selected').append(currentOption.options[toppingIndex].name);
                                if (toppingInputs.length !== ind + 1) { // If this option have more than one topping, append it with a separator
                                    $('#' + currentOption.name.replace(/&|\+/g, "_").replace(/ /g, "_") + currentOption.opt_scr_num + currentOption.opt_scr_seq + currentOption.typeId + '-selected').append(' | ');
                                }
                                if (toppingPrice) { // Recalculate total price
                                    totalPrice += parseFloat(toppingPrice);
                                    // IGR: añadir el precio si la opcion tiene elegida tiene precio añadido
                                    $('.required-' + index).append('<span> &nbsp; &nbsp; <b> $' + toppingPrice + '</b></span>')
                                }
                                if (currentOption.typeId === '2') {
                                    $('type-3').removeClass('hidden');
                                    $('type-1').addClass('hidden');
                                } else {
                                    $('type-3').addClass('hidden');
                                    $('type-1').removeClass('hidden');
                                }
                            }
                            $('.required-' + index).removeClass('has-error'); //just in case, remove has error class
                            $('.required-' + index + ' .fa-exclamation-triangle').addClass('hidden');
                        } else if (beforeAdding && topping.typeId === '0') { // Validate if we are checking before adding the product to the cart and the option is required
                            $('.required-' + index).html('<i class="fas fa-exclamation-triangle hidden" aria-hidden="true"></i> Choose one');
                            $('.required-' + index).addClass('has-error');
                            $('.required-' + index + ' .fa-exclamation-triangle').removeClass('hidden');
                            return false;
                        }
                    }
                    $('#addButtonPrice').text("$" + totalPrice.toFixed(2));
                    $('#addButtonPrice').data('price', totalPrice.toFixed(2));
                    $('.menu-product-description').find(".menu-product-info").find(".product-price").text("$" + totalPrice.toFixed(2));
                    
                    if (beforeAdding) {
                        $('#modalOptionsProduct').modal('hide');
                        return true;
                    }
                }

                function showModalBefore9(resConfig) {
                    var modal = $('#modalGeneric');
                    modal.find('.modal-title').text('Online Ordering');
                    modal.find('.modal-body').html('<p>' + resConfig.message + '</p>');
                    modal.find('.change-store-button').hide();
                    modal.find('#cancelButton').hide();
                    modal.modal('show');
                }


          

       $('#modalAddress select').change(function() {
      var theValue = $('option:selected').text();
        console.log(theValue);
     
        alert(theValue);
   
       });


                function checkCategoryAvailable() {

                    var lunchEspecials = document.URL.toLocaleLowerCase().toString().indexOf("lunch-specials") > -1;
                    if (app.globals.menuCart.orderDate == '2024-02-11' && lunchEspecials) {
                        //ocultar los botones y sacar una modal
                        $(".add-button.class-btAdd").hide();
                        app.utils.showErrorMessage("Info", "<b>Lunch Specials are not available for the Big Gameday Experience</b>");
                    }
                }
  </script>
  <div class="container-fluid footer">
   <div class="container">
    <img alt="" class="footer-logo hidden-xs hidden-sm" id="imgLogoFooter" src="https://api.duffysmvp.com/img/imagesLogo/79c2768c-471d-4b36-b710-757b572acf7d.png">
     <ul class="footer-sections">
      <li>
       <a href="/menu" target="_self">
        MENU
       </a>
      </li>
      <li>
       <a href="/events/" target="_self">
        EVENTS
       </a>
      </li>
      <li>
       <a href='javascript: openSubMenu("menu-category.aspx?name=party-platters", "62")' target="_self">
        PARTY PLATTERS
       </a>
      </li>
      <li>
       <a href="/locations" target="_self">
        LOCATIONS
       </a>
      </li>
      <li>
       <a href="/mvp" target="_self">
        MVP
       </a>
      </li>
      <li>
       <a href="/aboutus" target="_self">
        ABOUT
       </a>
      </li>
      <li>
       <a href="/giftcards" target="_self">
        GIFT CARDS
       </a>
      </li>
      <li>
       <a href="/careers" target="_self">
        Careers
       </a>
      </li>
      <li>
       <a href="javascript:goToPayOnline();" target="_self">
        ORDER ONLINE
       </a>
      </li>
     </ul>
     <ul class="footer-social">
      <li>
       <a href="https://www.facebook.com/duffysmvp" target="_blank">
        <i class="fab fa-facebook">
        </i>
       </a>
      </li>
      <li>
       <a href="https://twitter.com/duffysmvp" target="_blank">
        <i class="fab fa-twitter">
        </i>
       </a>
      </li>
      <li>
       <a href="https://www.instagram.com/duffysmvp/" target="_blank">
        <i class="fab fa-instagram">
        </i>
       </a>
      </li>
      <li>
       <a href="https://www.youtube.com/user/DuffysManagement" target="_blank">
        <i class="fab fa-youtube">
        </i>
       </a>
      </li>
     </ul>
    </img>
   </div>
  </div>
  <div class="container-fluid subfooter">
   <div class="container">
    <ul class="subfooter-sections">
     <li class="copyright">
      ©
                                2025 Duffy's Sports Grill
     </li>
     <!-- <li><a href="/contactus.aspx">Contact</a>
                    </li> -->
     <li>
      <a href="/press" target="_self">
       Press
      </a>
     </li>
     <li>
      <a href="/contactus" target="_self">
       Contact
      </a>
     </li>
     <li>
      <a href="https://duffysfoundation.org/" target="_blank">
       Foundation
      </a>
     </li>
     <li>
      <a href="/privacypolicy" target="_self">
       Privacy Policy
      </a>
     </li>
     <li>
      <a href="/cookiespolicy.aspx" target="_self">
       Cookies Policy
      </a>
     </li>
    </ul>
   </div>
  </div>
  <div class="advices-bar hidden" id="modalCookies">
   <div class="container">
    <div class="row">
     <div class="col-xs-12 col-md-10">
      <h2>
       <i class="fas fa-exclamation-circle">
       </i>
       Notice
      </h2>
      <p>
       By continuing to use our site, you agree to our
       <a href="/privacypolicy">
        Privacy Policy
       </a>
       and
       <a href="/cookiespolicy.aspx">
        Cookies Policy
       </a>
      </p>
     </div>
     <div class="col-xs-12 col-md-2">
      <button class="button button-light" data-dismiss="modal" id="okCookies" onclick="app.main.acceptCookies()" type="button">
       ACCEPT
      </button>
     </div>
    </div>
   </div>
  </div>
  <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
  <script type="text/javascript">
   var checkCardBalanceCaptchaContainer = '';
        var checkCardBalanceOLOCaptchaContainer = '';
        var checkModalLoginCaptchaContainer = '';
        var checkLoginMVPCaptchaContainer = "";
        window.LoginMVPCaptchaCallback = "";

        var onloadCallback = function () {
            console.log("Master recaptcha loaded");
            checkCardBalanceCaptchaContainer = grecaptcha.render('checkBalanceRecaptcha', {
                'sitekey': '6LfvR7oUAAAAAD5hq_xAL7zJKHJO0pUYXZCDdKEO',
                'callback': function (response) { window.checkGiftcardCaptchaCallback = response; }
            });

            checkCardBalanceOLOCaptchaContainer = grecaptcha.render('checkBalanceOLORecaptcha', {
                'sitekey': '6LfvR7oUAAAAAD5hq_xAL7zJKHJO0pUYXZCDdKEO',
                'callback': function (response) { window.checkGiftcardOLOCaptchaCallback = response; }
            });

            checkModalLoginCaptchaContainer = grecaptcha.render('ModalLoginRecaptcha', {
                'sitekey': '6LfvR7oUAAAAAD5hq_xAL7zJKHJO0pUYXZCDdKEO',
                'callback': function (response) { window.LoginModalCaptchaCallback = response; }
            });

            checkLoginMVPCaptchaContainer = grecaptcha.render('LoginMVPRecaptcha', {
                'sitekey': '6LfvR7oUAAAAAD5hq_xAL7zJKHJO0pUYXZCDdKEO',
                'callback': function (response) { window.LoginMVPCaptchaCallback = response; }
            });
        };
  </script>
  <script>
   // get the value of the bottom of the #main element by adding the offset of that element plus its height, set it as a variable
        // var mainbottom = $('.home-section').offset().top + $('.home-section').height();
        var mainbottom = window.innerHeight / 4;
        var lastOpened = '';

        // on scroll,
        $(window).on('scroll', function () {

            // we round here to reduce a little workload
            stop = Math.round($(window).scrollTop());
            if (stop > mainbottom) {
                $('.navbar').addClass('scrolling');
            } else {
                $('.navbar').removeClass('scrolling');
            }

        });


        $(document).ready(function () {

            $(".owl-carousel.promo-carousel").owlCarousel({
                loop: false,
                responsiveClass: true,
                autoplaySpeed: 500,
                autoplayTimeout: 10000,
                dots: false,
                nav: true,
                autoplay: true,
                navText: [,],
                responsive: {
                    0: {
                        items: 1,
                        margin: 10,
                    },
                    768: {
                        items: 2,
                        margin: 15,
                    },
                    1000: {
                        items: 3,
                        margin: 15,
                    }
                }
            });

            $(".owl-carousel.new-locations-carousel").owlCarousel({
                loop: true,
                responsiveClass: true,
                dots: false,
                nav: true,
                autoplay: true,
                navText: [,],

                responsive: {
                    0: {
                        items: 1,
                        margin: 10,
                    },
                    768: {
                        items: 2,
                        margin: 0,
                    },
                    1000: {
                        items: 3,
                        margin: 0,
                    }
                }
            });


            $(".owl-carousel.menu-carousel").owlCarousel({
                loop: true,
                responsiveClass: true,
                dots: false,
                nav: true,
                autoplay: false,
                URLhashListener: true,
                startPosition: 'URLHash',
                navText: [,],

                responsive: {
                    0: {
                        items: 3,
                        margin: 10,
                    },
                    768: {
                        items: 6,
                        margin: 0,
                    },
                    1200: {
                        items: 8,
                        margin: 0,
                    }
                }
            });


            $(".owl-carousel.press-highlights-carousel").owlCarousel({
                loop: true,
                dots: true,
                autoplaySpeed: 500,
                autoplayTimeout: 6000,
                autoplay: true,


                responsive: {
                    0: {
                        items: 1,
                        margin: 10,
                    },
                    768: {
                        items: 2,
                        margin: 0,
                    },
                    1200: {
                        items: 2,
                        margin: 0,
                    }
                }

            });

            $('.dropdown-toggle').dropdown();


            $('#restorePasswordForm').submit(function (event) {
                event.preventDefault();
                submitrestorePassword();
            });

            $('#modalOptionsProduct').on('hidden.bs.modal', function () {
                currentCollapse = '';
            })
            $(".owl-carousel.featured-carousel-1").owlCarousel({
                loop: true,
                dots: true,
                autoplaySpeed: 500,
                autoplayTimeout: 8000,
                navSpeed: 500,
                autoplay: true,
                items: 1,
            });

            $(".owl-carousel.featured-carousel-2").owlCarousel({
                loop: true,
                dots: true,
                autoplaySpeed: 500,
                autoplayTimeout: 8000,
                navSpeed: 500,
                autoplay: true,
                items: 1,
            });


            $(".owl-carousel.legacy-carousel").owlCarousel({
                dots: false,
                nav: true,
                navText: ["<i class='fas fa-chevron-left'></i>", "<i class='fas fa-chevron-right'></i>"],
                autoplaySpeed: 500,
                autoplayTimeout: 8000,
                navSpeed: 500,
                autoplay: true,
                loop: true,

                responsive: {
                    0: {
                        items: 1,
                        margin: 10,
                    },
                    768: {
                        items: 1,
                        margin: 10,
                    },
                    1200: {
                        items: 1,
                        margin: 10,
                    }
                }
            });


            $('#mobileCartButton').on('click', function () {
                $('.menu-links').hide();
                $('.navbar-nav .dropdown-personal').hide()
                $('.navbar-nav .dropdown-cart').show()
                $('.navbar-nav #dLabel .icon-bag').hide();
                $('.navbar-nav #dLabel .badge').hide();
                if (!$("#navbar-menu").hasClass("collapse in") || lastOpened === 'cartButton' || lastOpened === '') {
                    $('#navbar-menu').collapse('toggle');
                }
                lastOpened = 'cartButton';
            })

            $('#mobileNavBarButton').on('click', function () {
                $('.menu-links').show();
                $('.navbar-nav .dropdown-personal').show()
                $('.navbar-nav .dropdown-cart').hide()
                $('.navbar-nav #dLabel').hide();
                $('.navbar-nav .dropdown-menu::before').hide();
                if (!$("#navbar-menu").hasClass("collapse in") || lastOpened === 'navBarButton' || lastOpened === '') {
                    $('#navbar-menu').collapse('toggle');
                }
                lastOpened = 'navBarButton';
            })

            $('#navbar-menu').on('hidden.bs.collapse', function () {
                $('.menu-links').show();
                $('.navbar-nav .dropdown-personal').show();
                $('.navbar-nav .dropdown-cart').show();
                $('.navbar-nav #dLabel').show();
                $('.navbar-nav .dropdown-menu::before').show();
                $('.navbar-nav #dLabel .icon-bag').show();
                $('.navbar-nav #dLabel .badge').show();
            })

            $('#mvpTabs a').click(function (e) {
                e.preventDefault()
                $(this).tab('show');
            });




            $('#modalRestorePassword #username').on('keyup', function () {
                disableResetInputs();
            })

            $('#modalRestorePassword #card').on('keyup', function () {
                disableResetInputs();
            })

            $('#modalRestorePassword #email').on('keyup', function () {
                disableResetInputs();
            })
            initFormRegister();
            deleteCardInfo();

            //para poner un estilo especial a la última opción del menú. A la opción del ORDER ONLINE. si algún día cambia de orden, pues habrá que cambiarlo aqui. Ahora mismo es la mejor opción para hacerlo porque aunque sea dínamico, esta opción del meún lleva ahi toda la vida. 
            $($("#navbar-menu ul li")[$("#navbar-menu ul li").length - 2]).addClass("gold-bg");
        });

        function initFormRegister() {
            $('#mobilePhone').inputmask({ "mask": "(999) 999-9999" }); //specifying options
            $('[data-toggle="datepickerBirthday"]').datepicker({
                format: 'mm/dd/yyyy',
                changeMonth: true,
                changeYear: true,
                defaultDate: '-14y',
                yearRange: "c-70:c+3"
            });

            $("#registerForm").validate({
                errorClass: 'has-error fade in error-message',
                rules: {
                    firstName: {
                        required: true,
                        maxlength: 150
                    },
                    lastName: {
                        required: true,
                        maxlength: 150
                    },
                    mobilePhone: "required",
                    birthday: "required",
                    user: {
                        required: true,
                        minlength: 6,
                    },
                    location: "required",
                    pass: {
                        required: true,
                        minlength: 6,
                    },
                    repeatPass: {
                        required: true,
                        minlength: 6,
                        equalTo: "#pass"
                    },
                    emailRegister: {
                        required: true,
                        email: true,
                        maxlength: 150
                    },
                    repeatEmailRegister: {
                        equalTo: "#emailRegister",
                        email: true,
                        maxlength: 150
                    }
                }
            });

            $('#registerForm').submit(function (event) {
                event.preventDefault();
                if ($('#registerForm').valid()) {
                    submitRegister();
                }
            });

        }

        function deleteCardInfo() {
            //Check if current page isn't payment data, we delete card info for security purpose.
            if (window.location.pathname != "/confirmorder.aspx") {
                var cardInfo = {};

                app.globals.menuCart["cardInfo"] = cardInfo;
                app.main.updateStorage('menuCart');
            }
        }


        function enableRegisterButton() {
            if (document.querySelector('input[id=optPolicy]').checked) {
                $('#registerButton').removeClass('disabled');
            } else {
                $('#registerButton').addClass('disabled');
            }
        }

        function disableResetInputs() {
            $('#modalRestorePassword #username').prop('disabled', ($('#modalRestorePassword #card').val() !== '' || $('#modalRestorePassword #email').val() !== '' ? 'disabled' : ''))
            $('#modalRestorePassword #email').prop('disabled', ($('#modalRestorePassword #username').val() !== '' || $('#modalRestorePassword #card').val() !== '' ? 'disabled' : ''))
            $('#modalRestorePassword #card').prop('disabled', ($('#modalRestorePassword #username').val() !== '' || $('#modalRestorePassword #email').val() !== '' ? 'disabled' : ''))
        }

        function submitrestorePassword() {
            var username = $('#modalRestorePassword #username').val();
            var email = $('#modalRestorePassword #email').val();
            var card = $('#modalRestorePassword #card').val();
            var data = {
                username: username,
                email: email,
                card: card
            };
            if (username === '' && email === '' && card === '') {
                $('#modalRestorePassword .error-message span').text('You must write at least one option');
                $('#modalRestorePassword .error-message').show();
            } else {
                $('#modalRestorePassword .error-message').hide();
                app.ajax.restorePassword(data, function (res) {
                    $('#modalRestorePassword #update-success').show();
                    $('#modalRestorePassword #update-success').text('We have sent a email to ' + JSON.parse(res).email);
                    $('#restorePasswordButton').hide();
                }, function (err) {
                    $('#modalRestorePassword .error-message span').html(err.responseJSON.Message);
                    $('#modalRestorePassword .error-message').show();
                });
            }
        }

        function loadStores(userLogged) {

            app.ajax.comboStore(function (res) {
                app.globals.stores = res;
                console.log('loadStores:' + res.length + 'store:' + app.globals.user.StoreCode + 'userlogged:' + userLogged);

                $('#preferredLocation').html('');
                $('#location').html('');
                $('#location').append('<option value="" disabled selected>Choose Favorite Location</option>');
                $('#locationMissing').html('');
                for (var index = 0; index < res.length; index++) {
                    var store = res[index];
                    if (userLogged) {
                        if (app.globals.user.StoreCode === store.id) {
                            var storeHtml = '<option selected="true" value="' + store.id + '">' + store.name + '</option>';
                        } else {
                            var storeHtml = '<option value="' + store.id + '">' + store.name + '</option>';
                        }
                        $('#preferredLocation').append(storeHtml);
                        $('#locationMissing').append(storeHtml);
                    } else {
                        var storeHtml = '<option value="' + store.id + '">' + store.name + '</option>';
                        $('#location').append(storeHtml);
                        $('#locationMissing').append(storeHtml);
                    }
                    // $('#locationMissing').append(storeHtml);
                }
            }, function (err) {
                console.log("ERR GETTING LOCATIONS");
            })
            //app.utils.getPosition(function (lat, long) {
            //    var data = {
            //        latitude: lat,
            //        longitude: long
            //    }
            //    console.log("getPosition:", data);
            //    app.ajax.storeByLocation(data, function (res) {
            //        app.globals.stores = res;
            //        // $('#preferredLocation').html('');
            //        $('#location').html('');
            //        // $('#locationMissing').html('');
            //        console.log('getPosition:' + res.length + 'store:' + app.globals.user.StoreCode + 'userlogged:' + userLogged);

            //        for (var index = 0; index < res.length; index++) {
            //            var storeLoc = res[index];
            //            if (userLogged) {
            //                if (app.globals.user.StoreCode === storeLoc.code) {
            //                    var storeHtml = '<option selected="true" value="' + storeLoc.code + '">' + storeLoc.name + '</option>';
            //                } else {
            //                    var storeHtml = '<option value="' + storeLoc.code + '">' + storeLoc.name + '</option>';
            //                }
            //                //   $('#preferredLocation').append(storeHtml);
            //                $('#locationMissing').append(storeHtml);
            //            } else {
            //                var storeHtml = '<option value="' + storeLoc.code + '">' + storeLoc.name + '</option>';
            //                $('#location').append(storeHtml);
            //                //  $('#locationMissing').append(storeHtml);
            //            }
            //            // $('#locationMissing').append(storeHtml);
            //        }
            //    }, function (err) {
            //        console.log("ERR", err);
            //    })
            //}, function (err) {

            //})
        }

        function getCanadaStateName(state) {
            if (state.description.indexOf('Canada - ') >= 0) {
                return state.description.substr(state.description.indexOf(' - ') + 3, state.description.length)
            } else {
                return state.description;
            }
        }

        function submitRegister() {
            submitingCart = true;
            $("#registerButton span").toggle();
            $("#registerButton img").toggle();
            $("#registerFormContainer .error-message").hide();
            // var data = {};
            // $("#modalRegister :input").each(function () {
            //   var input = $(this); // This is the jquery object of the input, do what you will
            //   if (input[0].className.indexOf('button') === -1) {
            //     data[input.attr('id')] = input.val();
            //   }
            // });

            var data = {
                "firstName": $('#firstName').val(),
                "lastName": $('#lastName').val(),
                "mobilePhone": $('#mobilePhone').val(),
                "birthDate": $('#birthday').val(),
                "email": $('#emailRegister').val(),
                "location": '',
                "user": $('#user').val(),
                "pass": $('#pass').val(),
                "specialOffers": document.querySelector('input[id=optIn]').checked,
                "textCampaignOptIn": document.querySelector('input[id=textCampaignOptIn]').checked,
                "numberCard": $('#numberCard').val(),
                "regCodeCard": $('#registrationCode').val(),
                "promoCode": $('#promo').val(),
                "origin": 'web'
            }

            var location = $('#location')[0];
            data['location'] = location.options[location.selectedIndex].value;
            data['mobilePhone'] = data.mobilePhone.replace(/[^0-9]/g, '');
            app.ajax.register(data, function (res) {
                app.globals.user = res;
                $('#registerFormContainer.mvp-login-form').toggle();
                $('.row.done.register').show();
                $('#registerSuccess').text(res.message);
                app.utils.createAuthCookie(res.token);
                app.utils.createUsernameCookie(res.username);
                $("#registerButton span").toggle();
                $("#registerButton img").toggle();
                $("#registerFormContainer .error-message").hide();
            }, function (err) {
                $("#registerButton span").toggle();
                $("#registerButton img").toggle();
                $("#registerFormContainer .error-message span").html(err.responseJSON.Message);
                $("#registerFormContainer .error-message").show();
            })
        }


        function closeModalAndLogin() {
            var token = app.globals.user.token;
            app.main.showLoadingModal();
            app.ajax.loginToken(function (res) {
                app.globals.user = res;
                app.main.updateStorage('user');
                location.reload();
            });
        }

        currentCollapse = '';
        function controlCollapse(collSelected, typeId) {
            if (collSelected === currentCollapse) {
                $('#' + collSelected).collapse('hide');
                currentCollapse = '';
                return;
            }

            if (currentCollapse === '') {
                $('#' + collSelected).collapse('show');
                currentCollapse = collSelected;
            } else {
                $('#' + currentCollapse).collapse('hide');
                currentCollapse = collSelected;
                $('#' + currentCollapse).collapse('show');
            }
        }

        function openSubMenu(url, clickedId) {


            app.utils.sendAnalytics('menu', 'category', clickedId);

            if (clickedId === '21') {
                app.globals.navigateUrlPending = 'http://issuu.com/duffysmvp/docs/playbook_web_052213?e=8264500/2531206';
            } else if (clickedId === '20') {
                app.globals.navigateUrlPending = "/menu-category/menu-duffys-gluten-sensitive.pdf";
            } else {


                app.globals.navigateUrlPending = '/' + url;

            }



            if ((document.location.href.toString().indexOf($("#hidCategoryUrlf").val()) == -1) && app.globals.menuCart.OloType == null) {
                //if (app.utils.getMenuViewMode() != "payonline") {
                var navigateUrlPendingAux = app.globals.navigateUrlPending;
                window.open(navigateUrlPendingAux, '_self');
            }
            else {
                if (app.globals.user.Token || app.globals.user.iamguest) {
                    if (!!app.globals.menuCart.storeId && !!app.globals.menuCart.orderTime) {
                        var navigateUrlPendingAux = app.globals.navigateUrlPending;
                        app.globals.navigateUrlPending = "";
                        if (clickedId === '21') {
                            window.open(navigateUrlPendingAux, '_blank');
                        } else if (clickedId === '20') {
                            window.open(navigateUrlPendingAux, '_blank');
                        } else {
                            if (!!app.globals.menuCart.storeId && !!app.globals.menuCart.orderTime) {
                                navigateUrlPendingAux += '&store=' + app.globals.menuCart.storeId;
                            }
                            var first = $('.owl-item.active div')[0];
                            if (first.dataset && first.dataset.hash) {
                                navigateUrlPendingAux += "#" + first.dataset.hash;
                            }

                            window.open(navigateUrlPendingAux, '_self');

                        }
                    }
                    else {

                        app.utils.openStoresSelectModal();
                    }
                }
                else {
                    if (!!app.globals.menuCart.storeId && !!app.globals.menuCart.orderTime) {
                        var navigateUrlPendingAux = app.globals.navigateUrlPending;
                        app.globals.navigateUrlPending = "";
                        if (clickedId === '21') {

                        } else if (clickedId === '20') {

                        } else {
                            if (!!app.globals.menuCart.storeId && !!app.globals.menuCart.orderTime) {
                                navigateUrlPendingAux += '&store=' + app.globals.menuCart.storeId;
                            }
                            var first = $('.owl-item.active div')[0];
                            if (first.dataset && first.dataset.hash) {
                                navigateUrlPendingAux += "#" + first.dataset.hash;
                            }

                        }
                        app.globals.navigateUrlPending = navigateUrlPendingAux ;
                        app.globals.callbackLoginUser = gotoUrlPendingAux;
                        app.globals.callbackLoginGuest = gotoUrlPendingAux;
                    }
                    else {
                        app.globals.callbackLoginUser = app.utils.openStoresSelectModal;
                        app.globals.callbackLoginGuest = app.utils.openStoresSelectModal;

                    }
                    $('#modalLogin').modal('show');
                }

            }


        }

        function selectOLOTypeMethod(method) {

            app.ajax.getInitialConfiguration(function (resConfig) {
                //hubo un cambio en el método de getInitialConfiguration del back, y se añadieron nodos nuevos al json que se devuelve. Para adaptar esta función que estamos ejecutando solo nos interesa el nodo que se llama OLO
                for (var i = 0; i < resConfig.length; i++) {
                    if (resConfig[i].item == "OLO") {
                        resConfig = resConfig[i];
                    }
                }

                app.globals.menuCart.OloType = method;
                //app.main.updateStorage('menuCart');

                if (resConfig.value) {

                    if (method == "delivery") {
                        document.location.href = "https://order.online/business/Duffys-45973/?delivery=true";
                        return;
                    }

                    app.utils.setMenuViewMode('payonline');

                    $('#modalOloType').on('hidden.bs.modal', function () {
                        // console.log("AQUI ES DONDE SE ESTÁ PONIENDO EL METHOD='" + method + "'");
                        app.globals.menuCart.OloType = method;
                        var deliveryInfo = {
                            address: null
                        }



                        app.globals.menuCart.delivery = deliveryInfo;
                        app.main.updateStorage('menuCart');

                        if (app.globals.user.Token) {

                            app.utils.openStoresSelectModal();


                        }
                        else {
                            if (app.globals.menuCart.OloType == 'delivery') {

                                app.utils.openStoresSelectModal();


                            } else {

                                app.globals.callbackLoginUser = app.utils.openStoresSelectModal;
                                app.globals.callbackLoginGuest = app.utils.openStoresSelectModal;
                                $('#modalLogin').modal('show');
                            }

                        }
                    });

                    $('#modalOloType').modal('hide');


                } else {
                    $('#modalOloType').modal('hide');
                    showModalBefore9(resConfig);
                }
            }, function (err) {
                console.log("err", err);
            });


        }



        function gotoPickUp() {
            app.globals.menuCart.OloType = "pickUp";
            app.globals.navigateUrlPending = '/' + "menu.aspx";
            passToPayOnline();
        }

        function goToPayOnline(urlPending) {
            if (urlPending != undefined) {
                app.globals.navigateUrlPending = '/' + urlPending;
                app.globals.menuCart.OloType = null;
            }
            else {
                app.globals.navigateUrlPending = '/' + "menu.aspx";
            }


            passToPayOnline();
        }
        function passToPayOnline() {

            app.ajax.getInitialConfiguration(function (resConfig) {
                for (var i = 0; i < resConfig.length; i++) {
                    if (resConfig[i].item == "OLO") {
                        resConfig = resConfig[i];
                    }
                }
                if (resConfig.value) {
                    if (app.globals.menuCart.OloType && app.globals.menuCart.OloType != null) {
                        switch (app.globals.menuCart.OloType) {
                            case "delivery":
                                if ((app.globals.menuCart.OloType == 'delivery' && !app.globals.menuCart.delivery && (app.globals.menuCart.delivery.address).length <= 2) || (app.globals.menuCart.OloType == 'delivery' && app.globals.menuCart.delivery && !app.globals.menuCart.delivery.address)) {
                                    $('#modalOloType').modal('show');
                                }
                                console.log(app.globals.menuCart.storeId);
                                if (app.globals.menuCart.storeId == 'undefined' || !app.globals.menuCart.storeId || !app.globals.menuCart.orderTime) {
                                    $('#modalOloType').modal('show');
                                }
                                break;
                            case "pickUp":
                                //document.location.href = app.globals.navigateUrlPending;


                                if (resConfig.value) {
                                    if (app.globals.user.Token) {
                                        app.utils.openStoresSelectModal();
                                    }
                                    else {
                                        app.globals.callbackLoginUser = app.utils.openStoresSelectModal;
                                        app.globals.callbackLoginGuest = app.utils.openStoresSelectModal;
                                        $('#modalLogin').modal('show');
                                    }

                                } else {
                                    showModalBefore9(resConfig);
                                }


                                break;
                            default:
                                app.menuCart.clean();
                                app.utils.showErrorMessage("Error", "Sorry, we dropped the ball!<br/>Try again later");
                                break;
                        }


                    } else {
                        $('#modalOloType').modal('show');

                    }


                } else {
                    showModalBefore9(resConfig);
                }

            });



            ////app.utils.setMenuViewMode('payonline');

            ////var categoryId = $("#categoryId").val();
            ////var urlf = $("#hidCategoryUrlf").val();
            //console.log("olo type: '" + app.globals.menuCart.OloType+"'");

            //if (app.globals.menuCart.OloType && app.globals.menuCart.OloType != null) {
            //    switch (app.globals.menuCart.OloType) {
            //        case "delivery":
            //          if ((app.globals.menuCart.OloType == 'delivery' && !app.globals.menuCart.delivery && (app.globals.menuCart.delivery.address).length <= 2) || (app.globals.menuCart.OloType == 'delivery' && app.globals.menuCart.delivery && !app.globals.menuCart.delivery.address)) {
            //            $('#modalOloType').modal('show');
            //          }
            //          console.log(app.globals.menuCart.storeId);
            //          if (app.globals.menuCart.storeId == 'undefined' || !app.globals.menuCart.storeId || !app.globals.menuCart.orderTime) {
            //            $('#modalOloType').modal('show');
            //          }
            //            break;
            //        case "pickUp":
            //            //document.location.href = app.globals.navigateUrlPending;
            //            app.ajax.getInitialConfiguration(function (resConfig) {
            //                for (var i = 0; i < resConfig.length; i++) {
            //                    if (resConfig[i].item == "OLO") {
            //                        resConfig = resConfig[i];
            //                    }
            //                }
            //                if (resConfig.value) {
            //                    if (app.globals.user.Token) {
            //                        app.utils.openStoresSelectModal();
            //                    }
            //                    else {
            //                        app.globals.callbackLoginUser = app.utils.openStoresSelectModal;
            //                        app.globals.callbackLoginGuest = app.utils.openStoresSelectModal;
            //                        $('#modalLogin').modal('show');
            //                    }

            //                } else {
            //                    showModalBefore9(resConfig);
            //                }
            //            }, function (err) {
            //                console.log("err", err);
            //            });

            //            break;
            //        default:
            //            app.menuCart.clean();
            //            app.utils.showErrorMessage("Error", "Sorry, we dropped the ball!<br/>Try again later");
            //            break;
            //    }


            //} else {
            //    $('#modalOloType').modal('show');

            //}




        }



        function checkCardBalance() {
            var tokenRecaptcha = window.checkGiftcardCaptchaCallback;

            var cardNumber = $('#cardNumber').val();
            var cardType = $('#cardType').val();
            var cardRegCode = $('#cardRegCode').val();
            var data = {
                "giftCardNumber": cardNumber,
                "cardTemplateCode": cardType,
                "cardRegCode": cardRegCode,
                "tokenRecaptcha": tokenRecaptcha
            }

            if ((cardNumber === '') || (cardRegCode === '') || tokenRecaptcha === '') {
                var messageAux = "";
                if ((cardNumber === '') && (cardRegCode === '') && (tokenRecaptcha === '')) {
                    messageAux = "Please fill in all fields";
                }
                else {
                    if (cardNumber === '')
                        messageAux = "Please fill in card number field";
                    if (cardRegCode === '')
                        messageAux = "Please fill in Reg code field";
                    if (tokenRecaptcha === '')
                        messageAux = "Please check ReCAPTCHA";
                }

                $('#checkBalanceButton .loading-ico').hide();
                $('#checkBalanceButton span').show();
                $('#modalGiftCards .error-message').show();
                $('#modalGiftCards .error-message span').text(messageAux);
            } else {
                $('#checkBalanceButton .loading-ico').show();
                $('#checkBalanceButton span').hide();
                app.ajax.checkCardBalance(data, function (res) {
                    $('#modalGiftCards .error-message').hide();
                    $('.gift-card-check-balance').hide();
                    $('.gift-card-balance').show();
                    if (cardType === "4") {
                        var cardsHtml = '';
                        console.log(res);
                        res.forEach(function (card) {
                            // cardsHtml += '<h2 class="card-balance">' + card.balance + '</h2>';
                            cardsHtml += '<ul class="card-balance-list">';
                            cardsHtml += '<li>';
                            cardsHtml += '<span>$' + card.balance + '</span><span class="card-reward-name">' + card.name + '</span>';
                            cardsHtml += '<ul class="inset-card-balance-list">';
                            if (card.expirations) {
                                card.expirations.forEach(function (exp) {
                                    var expirationFixed = exp.expirationDate.split('-');
                                    expirationFixed = expirationFixed[1] + '/' + expirationFixed[2] + '/' + expirationFixed[0];
                                    cardsHtml += '<li >';
                                    cardsHtml += '<span>$' + exp.amount + '</span> expires on <span>' + expirationFixed + '</span>';
                                    cardsHtml += '</li>';
                                })
                            }
                            cardsHtml += '</ul></li>';
                            cardsHtml += '</ul>';
                        });
                        console.log(cardsHtml);
                        $('.card-balance-cont').html(cardsHtml);
                    } else {
                        $('.card-balance-cont').html('<h2 class="card-balance">' + '$' + res[0].balance + '</h2>');
                    }
                }, function (err) {

                    $('#checkBalanceButton .loading-ico').hide();
                    $('#checkBalanceButton span').show();
                    $('#modalGiftCards .error-message').show();
                    $('#modalGiftCards .error-message span').text(err.responseJSON.message);
                })
            }
            window.checkGiftcardCaptchaCallback = '';
            grecaptcha.reset(checkCardBalanceCaptchaContainer);
        }




        function showModalStore(storesCheck) {
            console.log('showModalStore');

            var storesWithOlo = $.grep(storesCheck, function (s) {
                return s.OLO;
            });

            var modal = $('#modalGeneric');
            if (storesWithOlo.length === 0) {
                modal.find('.modal-title').text('Online Ordering');
                modal.find('.modal-body').html('<p>There are no available stores for online ordering at this moment</p>');
                modal.find('.change-store-button').hide();
                modal.find('#cancelButton').hide();
                modal.find('#okButton').show();

            } else {
                modal.find('.modal-title').text('Online Ordering');
                modal.find('.modal-body').html('<p>These are the available stores and times for online ordering at this moment</p>');
                modal.find('.change-store-button').hide();
                modal.find('#cancelButton').hide();
                modal.find('#okButton').hide();
                //  modal.find('.modal-body').append('<div id="location-card-list " class="location-card-list location-card-list-cart col-xs-12 col-sm-12 col-md-12 col-lg-12">');
                storesWithOlo.forEach(function (store, index) {
                    var storeHtmlNew = '<div class="location-card">';

                    storeHtmlNew += '<div class="location-card-badges" >';

                    if (app.globals.user.StoreCode === store.code) {
                        storeHtmlNew += '        <div class="badge your-duffys">';
                        storeHtmlNew += '            <i class="fas fa-star"></i>Your Duffy\'s;'
                        storeHtmlNew += '        </div>';
                    }


                    if (store.openingDate !== '') {
                        storeHtmlNew += '     <div class="badge opening-date">';
                        storeHtmlNew += '        <i class="fas fa-flag"></i>'+store.openingDate;
                        storeHtmlNew += '    </div>';
                    }
                    storeHtmlNew += ' </div >';

                    storeHtmlNew += '     <span class="location-counter">';
                    storeHtmlNew += '        <h4>' + (index + 1) + '</h4>';
                    storeHtmlNew += '    </span>';

                    storeHtmlNew += '    <div class="location-card-head">';
                    storeHtmlNew += '        <h2 class="title">' + store.name + '</h2>';
                    //storeHtmlNew += '        <h3 class="pickup">at';
                    //storeHtmlNew += '<span>11:00h</span>';
                    //storeHtmlNew += '         </h3>';
                    storeHtmlNew += '     </div>';

                    storeHtmlNew += '    <div class="location-card-body">';

                    storeHtmlNew += '        <div class="location-address">';
                    storeHtmlNew += '            <p>';
                    storeHtmlNew += '                <span>' + store.address.address1 + '</span>';
                    storeHtmlNew += '                <br>';
                    storeHtmlNew += '                    <span>' + store.address.city + ', ' + store.address.stateProvince + ' ' + store.address.postalCode + '</span>';
                    storeHtmlNew += '            </p>';
                    storeHtmlNew += '           <p class="phone">' + store.address.phone + '</p>';
                    storeHtmlNew += '       </div>';

                    storeHtmlNew += '       <div class="store-timetable">';
                    store.hoursOfOperation.split(',').forEach(function (element, indHour) {
                        storeHtmlNew += '                <p>' + app.utils.splitHour(store.hoursOfOperation, indHour) + '</p>';
                    }, this);
                    storeHtmlNew += '        </div>';




                    //if (app.utils.getMenuViewMode() == "payonline") {
                    if (store.statusScheduleOLO.length) {
                        timesCount = 0;
                        var currentTime = new Date();
                        if (app.globals.menuCart.OloType == 'delivery') {
                            storeHtmlNew += '\n                            <div class="store-schedules">\n                                <p>Select Your Delivery Service</p>';
                        }
                        else {
                            storeHtmlNew += '\n                            <div class="store-schedules">\n                                <p> Next available time</p>';
                        }

                        var htmlSchedule = "";
                        var fistTimeASAP = "";
                        if (store.statusScheduleOLO.length) {
                            timesCount = 0;
                            var currentTime = new Date();

                            store.statusScheduleOLO.forEach(function (time) {
                                var timeString = (time.start_hour > 12 ? time.start_hour - 12 : time.start_hour) + ':' + (time.start_minute === 0 ? '00' : time.start_minute) + ' ' + (time.start_hour >= 12 ? 'pm' : 'am');
                                var timeStringValue = time.start_hour + ':' + (time.start_minute === 0 ? '00' : time.start_minute);
                                currentTime = new Date();
                                var unavailableMinutes = currentTime.getMinutes() + 15;
                                var currentHour = currentTime.getHours();
                                if (unavailableMinutes >= 60) {
                                    unavailableMinutes = unavailableMinutes - 60
                                    currentHour += 1;
                                }
                                var disabledTime = false; //currentHour >= time.start_hour && unavailableMinutes >= time.start_minute || currentHour > time.start_hour;
                                var maxOrders = time.activeOrder >= time.maxOrder;
                                // var disabledTime = currentTime.getHours() >= time.start_hour && currentTime.getMinutes() >= time.start_minute || currentTime.getHours() > time.start_hour;
                                // if (!disabledTime && timesCount <= 4) {
                                if (timesCount == 0) {
                                    fistTimeASAP = timeStringValue;
                                }
                                htmlSchedule += '<option myTime="' + timeStringValue + '" myStore="' + store.code + '"  myPrice="' + store.priceLevel + '" class="store-schedule transition ' + (time.activeOrder >= time.maxOrder ? 'disabled' : '') + '"> ' + timeString + ' </option>';
                                timesCount++;
                                //}
                            });

                        }

                        if (app.globals.menuCart.OloType == 'delivery') {


                            if (store.urlDelivery_uber != "") {
                                storeHtmlNew += '   <button onclick="clickDeliverStore(' + "'Uber Eats','" + store.urlDelivery_uber + "'" + ')" class="store-schedule">Uber Eats</button>';
                            }
                            if (store.urlDelivery_dudes != "") {
                                storeHtmlNew += '   <button onclick="clickDeliverStore(' + "'D.Dudes','" + store.urlDelivery_dudes + "'" + ')" class="store-schedule">D.Dudes</button>';
                            }
                            if (store.urlDelivery_biteSquad != "") {
                                storeHtmlNew += '   <button onclick="clickDeliverStore(' + "'BiteSquad','" + store.urlDelivery_biteSquad + "'" + ')" class="store-schedule">BiteSquad</button>';
                            }
                            if (store.urlDelivery_GrubHub != "") {
                                storeHtmlNew += '   <button onclick="clickDeliverStore(' + "'GrubHub','" + store.urlDelivery_GrubHub + "'" + ')" class="store-schedule">GrubHub</button>';
                            }
                            if (store.urlDelivery_DoorDash != "") {
                                storeHtmlNew += '   <button onclick="clickDeliverStore(' + "'DoorDash','" + store.urlDelivery_DoorDash + "'" + ')" class="store-schedule">DoorDash </button>';
                            }

                        }
                        else {
                            storeHtmlNew += '   <button onclick="setTimeASAP(' + "'" + fistTimeASAP + "'" + ',' + "'" + store.code + "'" + ',' + store.priceLevel + ')" class="store-schedule">ASAP</button>';
                            storeHtmlNew += '  <select class="store-schedule" onchange=setOOStore(this) name="olotime" id="chooseTime" >';
                            storeHtmlNew += '    <option value="#" disabled selected>Later</option>';
                            storeHtmlNew += htmlSchedule;


                            storeHtmlNew += '  </select>';
                        }

                        '</div>';
                    }


                     
                    if (app.globals.menuCart.OloType != 'delivery') {
                        if (store.code != "035") {
                             //aqui debería ir la nueva fila para poner las fechas futuras y sus horarios

                            storeHtmlNew += '<div class="store-schedules">' +
                                '<p>Thanksgiving Day</p>' +
                                '<select id="chooseSpecialDate" class="store-schedule" onchange="changeSpecialOrderDate(this)" name="olotime" id="chooseTime">' +
                                '<option value = "2025-11-27">2025/11/27</option></select> ' +
                                '<select class="store-schedule" onchange="setOOStore(this)" name="oloSpecialDates" id="chooseSpecialDateTime"><option value="#" disabled selected>Select Time</option>'

                            for (var i = 12; i <= 23; i++) {
                                storeHtmlNew += '<option myDate="2025-11-27" mytime="' + i.toString() + ':00" mystore="' + store.code + '" myprice="' + store.priceLevel + '" class="store-schedule transition " value="' + i.toString() + ':00">' + (i > 12 ? i - 12 : i) + ':00 ' + (i >= 12 ? 'pm' : 'am') + '</option>';
                                if (i < 23) {
                                    storeHtmlNew += '<option myDate="2025-11-27" mytime="' + i.toString() + ':30" mystore="' + store.code + '" myprice="' + store.priceLevel + '" class="store-schedule transition " value="' + i.toString() + ':30">' + (i > 12 ? i - 12 : i) + ':30 ' + (i >= 12 ? 'pm' : 'am') + '</option>';
                                }
                            }

                            storeHtmlNew += ' </select></div > ';
                        //fin de la nueva fila para poner las fechas futuras y sus horarios
                        }
                       

                    }
                     


                    storeHtmlNew += '        </div>';

                    storeHtmlNew += '     </div>';






                    modal.find('.modal-body').append(storeHtmlNew);

                    if (app.globals.menuCart.OloType == 'delivery') {
                        modal.find('.modal-footer').find("#btChangeToTakeOut").remove();
                        modal.find('.modal-footer').append('<button id="btChangeToTakeOut" class="button button-small button-yellow" style="color: #fff;background-color: #d8a60f;font-family: "Ubuntu Condensed";letter-spacing: 1px; border: 1px solid;text-transform: uppercase;display: inline-block; line-height: 1;" onclick="app.utils.changeToTakeOut()"><span>Change to Takeout</span></button>');
                    }
                    else {
                        modal.find('.modal-footer').find("#btChangeToTakeOut").remove();
                    }

                });
                // modal.find('.modal-body').append("</div>");


                app.globals.menuCart.OloType = "";
                app.main.updateStorage('menuCart');
            }
            modal.modal('show');
        }
        function clickDeliverStore(name, url) {
            app.utils.sendAnalytics('OO', 'deliever', name);
            window.location.href = url;
        }

        function enabledSearchLocationDelivery() {
            $("#search_location").removeAttr('disabled');
            $('#search-apt-number').removeAttr('disabled');
            $("#btnSearchDeliveryAddress").removeClass("hidden");
            $("#btnSearchDeliveryAddress").show();
            $("#btnChangeDeliveryAddress").hide();
            $('#modalAddress .store-delivery-container').html('');

        }

        function clickDeliverStore(name, url) {
            app.utils.sendAnalytics('OO', 'deliever', name);
            window.location.href = url;
        }

        function getDeliveryStore() {
            var geocoder = new google.maps.Geocoder();
            var address = $('#search_location').val();




            $('#modalAddress .store-delivery-container').html('');
            $('#idSearchMessage').html('');
            geocoder.geocode({
                'address': address,
                componentRestrictions: {
                    country: 'US',
                    administrativeArea: 'FL'
                }
            }, function (results, status) {
                if (status == google.maps.GeocoderStatus.OK) {
                    var address1 = results[0].address_components;
                    var zipcode = '';


                    for (var i = 0; i < address1.length; i++) {
                        if (address1[i].types.includes("postal_code")) { zipcode = address1[i].short_name; }

                    }
                    app.ajax.storeDelivery(results[0].geometry.location.lat(), results[0].geometry.location.lng(), zipcode, function (data) {

                        if (data.length <= 0 || data.code == null) {
                            $('#idSearchMessage').html('').append('<p>Delivery is unavailable in your area at this time</p>');
                        } else {
                            $('#idSearchMessage').html('');

                            app.globals.menuCart.SearchAddress = $('#search_location').val();
                            if ($.trim($("search-apt-number")) != "") {
                                app.globals.menuCart.SearchAddress = $.trim(app.globals.menuCart.SearchAddress.split("|")[0]) + " | " + $('#search-apt-number').val();
                            }
                            printStoreDelivery(data);

                        }
                    });
                } else {
                    $('#idSearchMessage').html('').append('<p>This is not a valid address. Please enter a valid address.</p>');
                }

            });



        }
        function setTimeASAP(asapTime, storeCode, priceL) {
            app.globals.menuCart.delivery.fee = 0;
            console.log('asap store' + storeCode);
            if (app.globals.menuCart.OloType == 'delivery') {
                if ($.trim($("search-apt-number")) != "") {
                    app.globals.menuCart.SearchAddress = $.trim(app.globals.menuCart.SearchAddress.split("|")[0]) + " | " + $('#search-apt-number').val();
                }

                app.globals.menuCart.delivery.address = app.globals.menuCart.SearchAddress;

            } else {

                app.globals.menuCart.OloType = "pickUp";
                app.globals.menuCart.delivery.address = "";
            }

            app.globals.menuCart.ASAP = true;

            app.main.updateStorage('menuCart');
            setDeliveryInfo(storeCode);
            chooseStoreAndTime('' + storeCode + '', '' + asapTime + '', '' + priceL + '', '');
        }

        function setDeliveryInfo(store_code) {
            if (app.globals.menuCart.OloType == 'delivery') {
                app.ajax.storeByCode(store_code, function (res) {
                    console.log(res);

                    app.globals.menuCart.delivery.fee = res.deliveryFee;
                    app.globals.menuCart.delivery.timeSlot = res.deliveryTimeMin;
                    console.log('delivert fee: ' + app.globals.menuCart.delivery.fee);
                    app.main.updateStorage('menuCart');
                }, function (err) {
                    console.log("ERR", err);
                });

            }
        }
        function setDeliveryAddress(select) {
            app.globals.menuCart.ASAP = false;
            console.log(select.options[select.selectedIndex].getAttribute("myStore"));
            console.log(select.options[select.selectedIndex].getAttribute("myPrice"));

            if ($.trim($("search-apt-number")) != "") {
                app.globals.menuCart.SearchAddress = $.trim(app.globals.menuCart.SearchAddress.split("|")[0]) + " | " + $('#search-apt-number').val();
            }


            app.globals.menuCart.delivery.address = app.globals.menuCart.SearchAddress;

            app.main.updateStorage('menuCart');
            setDeliveryInfo(select.options[select.selectedIndex].getAttribute("myStore"));
            chooseStoreAndTime(select.options[select.selectedIndex].getAttribute("myStore"), select.options[select.selectedIndex].getAttribute("myTime"), select.options[select.selectedIndex].getAttribute("myPrice"), select.options[select.selectedIndex].getAttribute("myDate"));
        }

        function setOOStore(select) {
            app.globals.menuCart.ASAP = false;
            app.globals.menuCart.delivery.fee = 0;
            app.globals.menuCart.OloType = "pickUp";
            app.main.updateStorage('menuCart');

            chooseStoreAndTime(select.options[select.selectedIndex].getAttribute("myStore"), select.options[select.selectedIndex].getAttribute("myTime"), select.options[select.selectedIndex].getAttribute("myPrice"), select.options[select.selectedIndex].getAttribute("myDate"));
        }
        function pad_with_zeroes(number, len) {
            var zeroes = "0".repeat(len);
            return zeroes.substring(number.toString().length, len) + number;
        }

        function calculateDeliveryTime(time, deliveryMin) {

            var timeToadd = "00:" + deliveryMin + ":00";  // Time to be added in min
            var timeToAddArr = timeToadd.split(":");
            var ms = (60 * 60 * parseInt(timeToAddArr[0]) + 60 * (parseInt(timeToAddArr[1]))) * 1000;

            var newTime = new Date('1970-01-01T' + time).getTime() + ms
            var finalTime1 = new Date(newTime).toLocaleString('en-US').slice(10, 21);
            var timeA = finalTime1.split(':');
            var finalTime = timeA[0] + ':' + timeA[1] + ' ' + finalTime1.slice(8, 11);



            return finalTime;
        }

        function printStoreDelivery(store) {
            var storeHtmlNew = '  <h3>Your order will be delivered to:</h3>' + app.globals.menuCart.SearchAddress;
            storeHtmlNew += '  <h3>Your order will be delivered by:</h3>';
            storeHtmlNew += '    <div class="location-card" id="location-card-list-assigned">';

            storeHtmlNew += '  <span class="location-counter">';
            storeHtmlNew += '   <h4>';
            storeHtmlNew += '   <i class="fas fa-car"></i>';
            storeHtmlNew += '   </h4>';
            storeHtmlNew += '  </span>';

            storeHtmlNew += '   <div class="location-card-head">';
            storeHtmlNew += '      <h2 class="title">' + store.name + '</h2>';
            storeHtmlNew += '   </div>';

            storeHtmlNew += '  <div class="location-card-body">';
            storeHtmlNew += '     <div class="location-address">';
            storeHtmlNew += '      <p>';
            storeHtmlNew += '        <span>' + store.address.address1 + '</span>';
            storeHtmlNew += '       <br>';
            storeHtmlNew += '      <span>' + store.address.city + ', ' + store.address.stateProvince + ' ' + store.address.postalCode + '</span>';
            storeHtmlNew += '   </p>';
            storeHtmlNew += '   <p class="phone">' + store.address.phone + '</p>';
            storeHtmlNew += '  </div>';

            storeHtmlNew += '       <div class="store-timetable">';
            store.hoursOfOperation.split(',').forEach(function (element, indHour) {
                storeHtmlNew += '                <p>' + app.utils.splitHour(store.hoursOfOperation, indHour) + '</p>';
            }, this);
            storeHtmlNew += '        </div>';

            storeHtmlNew += ' <div class="location-fees">';
            storeHtmlNew += '    <p><b>Delivery Fee:</b> $' + parseFloat(store.deliveryFee).toFixed(2) + '</p>';
            storeHtmlNew += '  </div>';
            storeHtmlNew += '   </div>';

            storeHtmlNew += '   <div class="store-schedules">';
            ///  storeHtmlNew += '       <p>Choose time</p>';
            var timeDisable = "";

            var fistTimeAsap = "";
            var htmlSheduleOLO = "";
            if (store.statusScheduleOLO.length) {
                timesCount = 0;
                var currentTime = new Date();

                store.statusScheduleOLO.forEach(function (time) {


                    var timeString = (time.start_hour > 12 ? time.start_hour - 12 : time.start_hour) + ':' + (time.start_minute === 0 ? '00' : time.start_minute) + ' ' + (time.start_hour >= 12 ? 'pm' : 'am');
                    var timeStringValue = time.start_hour + ':' + (time.start_minute === 0 ? '00' : time.start_minute);
                    currentTime = new Date();



                    //var time = "" + time.start_hour + ":" + pad_with_zeroes(time.start_minute, 2) + ":00"; // Original Time
                    //timeString = calculateDeliveryTime(time, store.deliveryTimeMin);

                    // console.log("PS:" + time + "FINAL: " + timeString);



                    var unavailableMinutes = currentTime.getMinutes() + 15;
                    var currentHour = currentTime.getHours();
                    if (unavailableMinutes >= 60) {
                        unavailableMinutes = unavailableMinutes - 60
                        currentHour += 1;
                    }
                    var disabledTime = false; //currentHour >= time.start_hour && unavailableMinutes >= time.start_minute || currentHour > time.start_hour;
                    var maxOrders = time.activeOrder >= time.maxOrder;
                    // var disabledTime = currentTime.getHours() >= time.start_hour && currentTime.getMinutes() >= time.start_minute || currentTime.getHours() > time.start_hour;
                    // if (!disabledTime && timesCount <= 4) {
                    if (timesCount == 0) { fistTimeAsap = timeStringValue; }
                    htmlSheduleOLO += '<option myTime="' + timeStringValue + '" myStore="' + store.code + '"  myPrice="' + store.priceLevel + '" class="store-schedule transition ' + (time.activeOrder >= time.maxOrder ? 'disabled' : '') + '"> ' + timeString + ' </option>';
                    timesCount++;
                    //}
                });

            }
            var asapOnClick = 'onclick=\"setTimeASAP(' + "'" + fistTimeAsap + "'" + ',' + "'" + store.code + "'" + ',' + store.priceLevel + ')\"';
            if (store.statusScheduleOLO.length <= 0) {
                timeDisable = ' disabled';
                storeHtmlNew += '       <p>Time is not available for this store</p>';
                asapOnClick = "";
            } else {
                storeHtmlNew += '       <p>Choose time</p>';
            }

            storeHtmlNew += '   <button ' + asapOnClick + ' class="store-schedule' + timeDisable + '">ASAP</button>';
            storeHtmlNew += '  <select class="store-schedule ' + timeDisable + '" onchange=setDeliveryAddress(this) name="olotime" id="chooseTime" >';
            storeHtmlNew += '    <option value="#" disabled selected>Later</option>';

            storeHtmlNew += htmlSheduleOLO;

            storeHtmlNew += '  </select>';
            storeHtmlNew += '  </div>';





            storeHtmlNew += '   </div>';
            $('#modalAddress .store-delivery-container').html('');
            $('#modalAddress .store-delivery-container').append(storeHtmlNew);
        }
        function chooseStoreChange(storeCode, time, priceLevel) {

            // app.menuCart.clean();


            if (app.globals.menuCart.items.length > 0) {

                var data1 = {

                    items: app.globals.menuCart.items,
                    storeId: storeCode

                }
                app.ajax.webServicePOST("updateOLOCart", data1, "",
                    function (response) {
                        //success
                        app.globals.menuCart.items = [];
                        app.globals.menuCart.items = response;
                        app.menuCart.updateCart();
                        app.menuCart.recalculatePrice();
                        console.log('cart was updated');

                        app.globals.menuCart.storeId = storeCode;
                        app.globals.menuCart.orderTime = time;
                        app.globals.menuCart.priceLevel = priceLevel;
                        app.main.updateStorage('menuCart');
                        location.href = "/menu.aspx";

                    },
                    function (err) {
                        app.utils.console("Ha habido un error en updateOLOCart" + err);
                        console.error(err);


                    });
            } else {
                app.globals.menuCart.storeId = storeCode;
                app.globals.menuCart.orderTime = time;
                app.globals.menuCart.priceLevel = priceLevel;
                app.main.updateStorage('menuCart');
                location.href = "/menu.aspx";

            }


        }


        function chooseStoreAndTime(storeCode, time, priceLevel, orderDate) {

            if (app.globals.menuCart.priceLevel != priceLevel && app.globals.menuCart.priceLevel != null && app.globals.menuCart.priceLevel != undefined && app.globals.menuCart.items != null && app.globals.menuCart.items.length > 0) {
                //app.menuCart.clean();
                //app.globals.menuCart.storeId = storeCode;
                //app.globals.menuCart.orderTime = time;
                // app.globals.menuCart.priceLevel = priceLevel;
                //app.main.updateStorage('menuCart');
                // $('#modalGeneric').modal("hide");
                app.main.hideLoadingModal();


                app.utils.showChangeStoreMessage("Change Store", 'Warning:  Your bag  prices could change', storeCode, time, priceLevel);


                //chooseStoreChange(storeCode, time, priceLevel);    
                // location.href = "/menu";
            }
            else {
                var storeIdAux = app.globals.menuCart.storeId;
                app.globals.menuCart.storeId = storeCode;
                app.globals.menuCart.priceLevel = priceLevel;

                app.globals.menuCart.orderTime = time;
                app.globals.menuCart.orderDate = orderDate;
                app.main.updateStorage('menuCart');
                app.utils.setMenuViewMode('payonline');


                if (!!app.globals.navigateUrlPending) {
                    if (app.globals.navigateUrlPending.toString().indexOf("?") < 0) {
                        window.open(app.globals.navigateUrlPending, '_self');
                    }
                    else {
                        var navigateUrlPendingAux = app.globals.navigateUrlPending + "&store=" + storeCode;
                        app.globals.navigateUrlPending == "";

                        var first = $('.owl-item.active div')[0];
                        if (first) {
                            if (first.dataset && first.dataset.hash) {
                                navigateUrlPendingAux += "#" + first.dataset.hash;
                            }
                        }


                        //if (storeIdAux == storeCode) {
                        //    location.reload();

                        //}
                        //else {
                        if (navigateUrlPendingAux[0] != "/") {
                            navigateUrlPendingAux = "/" + navigateUrlPendingAux;

                        }




                        if (document.URL.toString().indexOf(navigateUrlPendingAux) >= 0) {

                            $('#modalGeneric').modal("hide");
                        }
                        else {
                            window.open(navigateUrlPendingAux, '_self');
                        }

                        //}

                    }


                }
                else {

                    location.reload();
                }


            }



        }


        var typeRange = "";
        var wallet_codeGiftCard = "";
        $(function () {
            if (app.globals.user.Avatar != "") {
                $("#divSelectRange .img-user-container img").attr("src", app.globals.user.Avatar);
            }
            $("#divSelectRange #fullName").html(app.globals.user.Name);
            $("#divSelectRange #userMoney").html(app.globals.user.HBalance);
            $("#divSelectRange #userPoints").html(app.globals.user.Points);



        });

        function openRewarDollarModal(rewardType) {
            $("#reward-dollar-modal .googleRecaptcha").hide();
            $("#Error-Reward-dollar-modal").hide();
            $("#divSelectRange .range-content input").val("");
            $("#divCheckCardNum #inputNumCardDiscount").val("");
            $("#divCheckCardNum #inputNumCardDiscountRegCode").val("");
            $("#divCheckCardNum #inputNumCardDiscount").removeClass("has-error fade in error-message");
            $("#divCheckCardNum #inputNumCardDiscountRegCode").removeClass("has-error fade in error-message");
            switch (rewardType) {
                case "rewardDollar":
                    $("#reward-dollar-modal .googleRecaptcha").hide();
                    $(".googleRecaptcha")
                    if (app.globals.user.Token) {

                        app.ajax.loginToken(function (resultado) {
                            // app.ajax.getUserInfo(function (res) {
                            app.globals.user = resultado;
                            app.main.updateStorage('user');

                            var balanceRewardsDollarsEnableds_aux = 0;
                            var textRewardsDollarsEnabled_aux = "You can redeeem Reward Dollars for these products in your bag:<ul>";
                            //comprobar que items del carrito están habilitados para aplicarles Rewards Dollars.
                            app.ajax.checkRewardsDollarsItems(function (res) {
                                console.log("checkRewardsDollarsItems", res);
                                for (var i = 0; i < res.length; i++) {
                                    balanceRewardsDollarsEnableds_aux += parseFloat(res[i].totalPrice);
                                    textRewardsDollarsEnabled_aux += "<li>" + res[i].name.replace("'", "´") + " ($" + res[i].totalPrice.toString() + ")</li>";
                                }
                                textRewardsDollarsEnabled_aux += "</ul>";
                                balanceRewardsDollarsEnableds_aux = parseFloat(balanceRewardsDollarsEnableds_aux).toFixed(2);
                                console.log("balanceRewardsDollarsEnableds_aux:" + balanceRewardsDollarsEnableds_aux.toString());

                                typeRange = "rewardDollar";
                                // maxTotalRange = app.globals.user.HBalance;
                                maxTotalRange = app.globals.user.HBalance;
                                $("#divSelectRange #userMoney").html(app.globals.user.HBalance);
                                $("#divSelectRange #userPoints").html(app.globals.user.Points);

                                let couponDiscountPromoCode = app.globals.menuCart.oloCouponDiscount?.totalCouponDiscount;
                                if (couponDiscountPromoCode == undefined) {
                                    couponDiscountPromoCode = 0;
                                }
                                else {
                                    couponDiscountPromoCode = parseFloat(couponDiscountPromoCode);
                                }
                                if (parseFloat(maxTotalRange) > parseFloat((app.globals.menuCart.totalPrice - app.globals.menuCart.discount - app.globals.menuCart.PXdiscount))) {
                                    //maxTotalRange = app.utils.getCartFinalPrice() ;
                                    maxTotalRange = (app.globals.menuCart.totalPrice - app.globals.menuCart.discount - app.globals.menuCart.PXdiscount - couponDiscountPromoCode);
                                }
                                if (parseFloat(maxTotalRange) > parseFloat(balanceRewardsDollarsEnableds_aux)) {
                                    maxTotalRange = parseFloat(balanceRewardsDollarsEnableds_aux);
                                }


                                $("#divSelectRange .range-content .modal-reward-form span").html("/ $" + parseFloat(maxTotalRange).toFixed(2) + "<span class='d-inline-block' tabindex='0' data-toggle='tooltip' data-html='true' title='" + textRewardsDollarsEnabled_aux + "'> <i class='fas fa-info-circle'></i></span>");
                                $("#divCheckCardNum").hide();
                                $("#divSelectRange").show();
                                $("#divRangeRewardDollar").show();
                                $("#divRangePartnerPlus").hide();
                                $("#btApply").show();
                                $("#btCheckCard").hide();
                                $("#reward-dollar-modal").modal('show');
                                $('[data-toggle="tooltip"]').tooltip();


                            }, function (err) {
                                console.log("checkRewardsDollarsItems Err", err);
                            })





                        }, function (err) {
                            app.globals.user.Token = false;
                        });

                    }
                    break;
                case "partnerPlus":
                    $("#reward-dollar-modal .googleRecaptcha").show();
                    typeRange = "PartnerPlus";
                    $("#divCheckCardNum").show();
                    $("#divCheckCardNum #imgCardType").attr("src", "/images/cards/partner-plus-card.png");

                    $("#divSelectRange").hide();
                    $("#divRangeRewardDollar").hide();
                    $("#divRangePartnerPlus").show();
                    $("#btApply").hide();
                    $("#btCheckCard").show();
                    $("#reward-dollar-modal").modal('show');
                    break;
                case "giftCard":
                    $("#reward-dollar-modal .googleRecaptcha").show();
                    typeRange = "giftCard";
                    $("#divCheckCardNum").show();
                    $("#divCheckCardNum #imgCardType").attr("src", "/images/cards/giftcard.png");

                    $("#divSelectRange").hide();
                    $("#divRangeRewardDollar").hide();
                    $("#divRangePartnerPlus").show();
                    $("#btApply").hide();
                    $("#btCheckCard").show();
                    $("#reward-dollar-modal").modal('show');
                    break;
                default:
            }


        }



        function checkPartnerPlusCardDiscount() {

            var tokenRecaptcha = window.checkGiftcardOLOCaptchaCallback;
            var cardNumber = $("#divCheckCardNum #inputNumCardDiscount").val();
            var cardRegCode = $('#divCheckCardNum  #inputNumCardDiscountRegCode').val();
            var cardType = 4;
            $("#divRangePartnerPlus #imgCardType").attr("src", "/images/cards/partner-plus-card.png");

            if (typeRange == "giftCard") {
                cardType = 3;
                $("#divRangePartnerPlus .card-img.header img").attr("src", "/images/cards/giftcard.png");
            }
            $("#divCheckCardNum #inputNumCardDiscount").removeClass("has-error fade in error-message");
            $("#divCheckCardNum #inputNumCardDiscountRegCode").removeClass("has-error fade in error-message");
            if (cardNumber == "" && cardRegCode == "") {
                $("#divCheckCardNum #inputNumCardDiscount").addClass("has-error fade in error-message");
                $("#divCheckCardNum #inputNumCardDiscountRegCode").addClass("has-error fade in error-message");
                return;
            } else if (cardNumber == "") {
                $("#divCheckCardNum #inputNumCardDiscount").addClass("has-error fade in error-message");
                return;
            } else if (cardRegCode == "") {
                $("#divCheckCardNum #inputNumCardDiscountRegCode").addClass("has-error fade in error-message");
                return;
            }

            if (cardNumber != "") {
                var data = {
                    "giftCardNumber": cardNumber,
                    "cardTemplateCode": cardType,
                    "cardRegCode": cardRegCode,
                    "tokenRecaptcha": tokenRecaptcha
                }

                var existCard = false;
                if (cardType == 3) {
                    if (app.globals.menuCart['giftCards'].length > 0) {
                        for (var i = 0; i < app.globals.menuCart['giftCards'].length; i++) {
                            if (cardNumber == app.globals.menuCart['giftCards'][i]["cardNumber"]) { existCard = true; }
                        }
                    }
                } else {
                    if (app.globals.menuCart['parthnerPlus'].length > 0) {
                        for (var i = 0; i < app.globals.menuCart['parthnerPlus'].length; i++) {
                            console.log(app.globals.menuCart['parthnerPlus'][i]["cardNumber"]);
                            if (cardNumber == app.globals.menuCart['parthnerPlus'][i]["cardNumber"]) { existCard = true; }
                        }
                    }

                }
                if (existCard == true) {
                    $("#Error-Reward-dollar-modal span").text("This card has been already applied");
                    $("#Error-Reward-dollar-modal").show();
                    return;
                }


                app.ajax.checkCardBalance(data, function (res) {
                    if (res.length > 0) {
                        maxTotalRange = res[0].balance;
                        if (maxTotalRange > 0) {



                            wallet_codeGiftCard = res[0].walletCode;

                            var totalFinalPrice = parseFloat((app.globals.menuCart.totalPrice - app.globals.menuCart.discount - app.globals.menuCart.PXdiscount));
                            if (cardType == 3) {
                                var deliveryFeeGift = 0;
                                if (app.globals.menuCart.delivery) {
                                    if (app.globals.menuCart.delivery.fee) {
                                        deliveryFeeGift = parseFloat(app.globals.menuCart.delivery.fee);
                                    }
                                }
                                totalFinalPrice = parseFloat(app.utils.getCreditCartCost());

                            }
                            console.log('total:' + totalFinalPrice);
                            if (parseFloat(maxTotalRange) > totalFinalPrice) {
                                maxTotalRange = totalFinalPrice;

                            }
                            if (totalFinalPrice > 0) {
                                $("#btApply").show();
                            }
                            $("#divSelectRange .range-content .modal-reward-form span").html("/ $" + parseFloat(maxTotalRange).toFixed(2));

                            $("#btCheckCard").hide();

                            $("#divRangePartnerPlus .mvp-balanceResumen p").html("Number: " + cardNumber);
                            $("#divRangePartnerPlus .mvp-balanceResumen span b").html(res[0].balance);
                            $("#divRangePartnerPlus").show();
                            $("#divCheckCardNum").hide();
                            $("#divSelectRange").show();

                            $("#Error-Reward-dollar-modal").hide();
                        }
                        else {
                            $("#Error-Reward-dollar-modal span").text("This card has $" + maxTotalRange + " remaining.");
                            $("#Error-Reward-dollar-modal").show();
                            grecaptcha.reset(checkCardBalanceOLOCaptchaContainer);

                        }
                    }
                    else {
                        $("#Error-Reward-dollar-modal span").text("Invalid Card Number");
                        $("#Error-Reward-dollar-modal").show();
                        grecaptcha.reset(checkCardBalanceOLOCaptchaContainer);
                    }



                }, function (err) {
                    $("#Error-Reward-dollar-modal span").text(err.responseJSON.message);
                    $("#Error-Reward-dollar-modal").show();
                    grecaptcha.reset(checkCardBalanceOLOCaptchaContainer);
                })
            }
            else {
                $("#Error-Reward-dollar-modal span").text(err.responseJSON.message);
                $("#Error-Reward-dollar-modal").show();
                grecaptcha.reset(checkCardBalanceOLOCaptchaContainer);
            }
        }


        function applyTotalRange() {
            //var totalAux = 0;
            //switch (typeRange) {
            //    case "rewardDollar":
            //        totalAux = app.globals.user.HBalance;
            //        break;
            //    case "PartnerPlus":
            //        totalAux = balancePartnerPlusSelected; 
            //        break;

            //    default:
            //}
            $("#divSelectRange .range-content input").val(parseFloat(maxTotalRange.toString().replace(",", ".")).toFixed(2));
            switch (typeRange) {
                case "rewardDollar":


                    break;
                case "PartnerPlus":


                    break;
                case "giftCard":


                default:
            }

        }


        function applyDiscountReward() {
            var totalDiscountAux = $("#divSelectRange .range-content input").val().replace(",", ".");

            totalDiscountAux = parseFloat(totalDiscountAux);
            console.log(totalDiscountAux);
            if (totalDiscountAux > 0 && totalDiscountAux.toString() != "NaN") {
                switch (typeRange) {
                    case "rewardDollar":
                        if (parseFloat(totalDiscountAux) > parseFloat(maxTotalRange)) {
                            $("#divSelectRange .range-content input").val(parseFloat(maxTotalRange).toFixed(2));
                        }
                        else {
                            $('#btRewardsDollars .reward-button-text.rewards-apply').addClass("hidden");
                            $('#btRewardsDollars .reward-button-text.rewards-edit').removeClass("hidden");
                            $('#btRewardsDollars .reward-button-text.rewards-edit p').html("$" + totalDiscountAux.toString() + " dollars applied");
                            $("#reward-dollar-modal").modal('hide');
                            $("#btRewards").addClass("disabled");

                            if (app.globals.user.hasManagerDollar == true) {
                                $("#btPartnerPlus").addClass("disabled");
                            }



                            app.globals.menuCart.rewardsDollars.push({ "cardNumber": "", "amount": totalDiscountAux, "wallet_code": wallet_codeGiftCard });
                            app.main.updateStorage('menuCart');
                            app.menuCart.updateCart();
                            app.menuCart.recalculatePrice();
                            printProducts();
                        }
                        break;
                    case "PartnerPlus":
                        if (parseFloat(totalDiscountAux) > parseFloat(maxTotalRange)) {
                            $("#divSelectRange .range-content input").val(parseFloat(maxTotalRange).toFixed(2));
                        }
                        else {
                            $('#btPartnerPlus .reward-button-text.rewards-apply').addClass("hidden");
                            $('#btPartnerPlus .reward-button-text.rewards-edit').removeClass("hidden");
                            var PartnerPlusDollars1 = 0;
                            if (app.globals.menuCart['parthnerPlus'].length > 0) {
                                for (var i = 0; i < app.globals.menuCart['parthnerPlus'].length; i++) {
                                    PartnerPlusDollars1 += parseFloat((app.globals.menuCart['parthnerPlus'][i]["amount"]).toFixed(2));

                                }
                            }
                            $('#btPartnerPlus .reward-button-text.rewards-edit p').html("$" + (PartnerPlusDollars1 + parseFloat(totalDiscountAux.toString())).toString() + " dollars applied");
                            $("#btRewards").addClass("disabled");
                            //$("#btRewardsDollars").addClass("disabled");
                            $("#reward-dollar-modal").modal('hide');


                            if (app.globals.user.hasManagerDollar == true) {
                                $("#btRewardsDollars").addClass("disabled");
                            }



                            var cardNumber = $("#divCheckCardNum #inputNumCardDiscount").val();
                            //  app.globals.menuCart.parthnerPlus.push({ "cardNumber": cardNumber, "amount": totalDiscountAux });
                            app.globals.menuCart.parthnerPlus.push({ "cardNumber": cardNumber, "amount": totalDiscountAux, "wallet_code": wallet_codeGiftCard });
                            app.main.updateStorage('menuCart');
                            app.menuCart.updateCart();
                            app.menuCart.recalculatePrice();
                            printProducts();
                        }
                        break;
                    case "giftCard":
                        if (parseFloat(totalDiscountAux) > parseFloat(maxTotalRange)) {
                            $("#divSelectRange .range-content input").val(parseFloat(maxTotalRange).toFixed(2));
                        }
                        else {
                            $('#btPaymentGiftCard .reward-button-text.rewards-apply').addClass("hidden");

                            var giftCardsDollars1 = 0;
                            if (app.globals.menuCart['giftCards'].length > 0) {
                                for (var i = 0; i < app.globals.menuCart['giftCards'].length; i++) {
                                    giftCardsDollars1 += parseFloat(app.globals.menuCart['giftCards'][i]["amount"]);

                                }
                            }
                            $('#btPaymentGiftCard .reward-button-text.rewards-edit').removeClass("hidden");
                            $('#btPaymentGiftCard .reward-button-text.rewards-edit p').html("$" + (giftCardsDollars1 + parseFloat(totalDiscountAux.toString())).toString() + " dollars applied");
                            $("#reward-dollar-modal").modal('hide');




                            var cardNumber = $("#divCheckCardNum #inputNumCardDiscount").val();
                            app.globals.menuCart.giftCards.push({ "cardNumber": cardNumber, "amount": totalDiscountAux, "wallet_code": wallet_codeGiftCard });
                            app.main.updateStorage('menuCart');
                            app.menuCart.updateCart();
                            app.menuCart.recalculatePrice();
                            printProducts();

                            if (app.utils.getCreditCartCost() <= 0) {
                                var cardInfo = {};
                                app.globals.menuCart["cardInfo"] = cardInfo;
                                $("#btPaymentCard ").addClass("disabled");
                            }
                        }
                        break;
                    default:
                }
            } else {
                $("#divSelectRange .range-content input").validate({
                    errorClass: 'has-error fade in error-message',
                    rules: {
                        numberInput: "required"

                    }
                });
            }

        }


        function removeRewarDollarApplied() {
            $("#divSelectRange .range-content input").val("");
            $('#btRewardsDollars .reward-button-text.rewards-apply').removeClass("hidden");
            $('#btRewardsDollars .reward-button-text.rewards-edit').addClass("hidden");
            $('#btRewardsDollars .reward-button-text.rewards-edit p').html("");
            $("#btRewards").removeClass("disabled");
            $("#btPartnerPlus").removeClass("disabled");


            app.globals.menuCart.rewardsDollars = [];
            app.main.updateStorage('menuCart');
            app.menuCart.updateCart();
            initial();

        }

        function removePartnerPlusApplied() {
            $("#divSelectRange .range-content input").val("");
            $('#btPartnerPlus .reward-button-text.rewards-apply').removeClass("hidden");
            $('#btPartnerPlus .reward-button-text.rewards-edit').addClass("hidden");
            $('#btPartnerPlus .reward-button-text.rewards-edit p').html("");
            $("#btRewards").removeClass("disabled");
            $("#btRewardsDollars").removeClass("disabled");

            app.globals.menuCart.parthnerPlus = [];
            app.main.updateStorage('menuCart');
            app.menuCart.updateCart();

            initial();
        }

        function removeGiftCardApplied() {
            $("#divSelectRange .range-content input").val("");
            $('#btPaymentGiftCard .reward-button-text.rewards-apply').removeClass("hidden");
            $('#btPaymentGiftCard .reward-button-text.rewards-edit').addClass("hidden");
            $('#btPaymentGiftCard .reward-button-text.rewards-edit p').html("");

            app.globals.menuCart.giftCards = [];
            app.main.updateStorage('menuCart');
            app.menuCart.updateCart();
            printProducts();


            $("#btPaymentCard").removeClass("disabled");

        }


        function gotoUrlPendingAux() {
            var navigateUrlPendingAux = app.globals.navigateUrlPending;
            app.globals.navigateUrlPending = "";
            window.open(navigateUrlPendingAux, '_self');
        }

        function changeSpecialOrderDate(element) {
            var specialDateSelected =$(element).val();
            $(element).next().find("option").attr('myDate', specialDateSelected);
            //$("#chooseSpecialDateTime option").attr('myDate', specialDateSelected);
        }
  </script>
  <script src="/js/polyfill.object-fit.js">
  </script>
  <script src="/js/aos.js">
  </script>
  <script src="/js/parallax.min.js">
  </script>
  <script defer="" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBXOXMxtlNZ0SchB0uUlQEEharPUnlBpDw&amp;libraries=places&amp;callback=initMap">
  </script>
  <script>
   (function (document, tag) { var script = document.createElement(tag); var element = document.getElementsByTagName('body')[0]; script.src = 'https://acsbap.com/apps/app/assets/js/acsb.js'; script.async = true; script.defer = true; (typeof element === 'undefined' ? document.getElementsByTagName('html')[0] : element).appendChild(script); script.onload = function () { acsbJS.init({ statementLink: '', feedbackLink: '', footerHtml: '', hideMobile: false, hideTrigger: false, language: 'en', position: 'right', leadColor: '#146FF8', triggerColor: '#146FF8', triggerRadius: '50%', triggerPositionX: 'right', triggerPositionY: 'bottom', triggerIcon: 'default', triggerSize: 'medium', triggerOffsetX: 20, triggerOffsetY: 20, mobile: { triggerSize: 'small', triggerPositionX: 'right', triggerPositionY: 'bottom', triggerOffsetX: 0, triggerOffsetY: 0, triggerRadius: '0' } }); }; }(document, 'script'));
  </script>
  <!-- <script>
        	objectFit.polyfill({
        		selector: '.location-image-home', // this can be any CSS selector
        		fittype: 'cover', // either contain, cover, fill or none
        		disableCrossDomain: 'true' // either 'true' or 'false' to not parse external CSS files.
        	});
        </script> -->
 </body>
</html>
